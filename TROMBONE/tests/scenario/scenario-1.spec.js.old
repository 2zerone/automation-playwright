import { test, expect } from '@playwright/test';
import fs from 'fs';
import path from 'path';
import { fileURLToPath } from 'url';
import TaskCodeManager from '../../lib/classes/TaskCodeManager.js';
import ToolchainManager from '../../lib/classes/ToolchainManager.js';
import RepositoryManager from '../../lib/classes/RepositoryManager.js';
import UserTaskCodeManager from '../../lib/classes/UserTaskCodeManager.js';
import SonarQubeManager from '../../lib/classes/SonarQubeManager.js';
import JUnitManager from '../../lib/classes/JUnitManager.js';
import PipelineManager from '../../lib/classes/PipelineManager.js';
import WorkflowComponentManager from '../../lib/classes/WorkflowComponentManager.js';
import LoginManager from '../../lib/classes/LoginManager.js';
import TicketCreateManager from '../../lib/classes/TicketCreateManager.js';
import TicketApproachManager from '../../lib/classes/Ticket_Approach.js';
import TicketApproval from '../../lib/classes/TicketApproval.js';
import GitLabManager from '../../lib/classes/GitLabManager.js';
import ApprovalManager from '../../lib/classes/ApprovalManager.js';
import TicketCodeReviewManager from '../../lib/classes/Ticket_CodeReview.js';
import TicketCodeMergeSTGManager from '../../lib/classes/Ticket_CodeMerge_STG.js';
import TicketCodeMergePRDManager from '../../lib/classes/Ticket_CodeMerge_PRD.js';
import TicketUnitTestManager from '../../lib/classes/Ticket_UnitTest.js';
import TicketManualDeploymentSTGManager from '../../lib/classes/Ticket_ManualDeployment_STG.js';
import TicketManualDeploymentPRDManager from '../../lib/classes/Ticket_ManualDeployment_PRD.js';
import TicketIntegrationTestManager from '../../lib/classes/Ticket_IntegrationTest.js';
import TicketDeploymentInformationManager from '../../lib/classes/Ticket_DeploymentInformation.js';
import TicketStaticAnalysisManager from '../../lib/classes/Ticket_StaticAnalysis.js';
  import utils from '../../lib/classes/TromboneUtils.js';

const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);

// ê¸€ë¡œë²Œ í…ŒìŠ¤íŠ¸ íƒ€ì„ì•„ì›ƒ ì„¤ì • (1ì‹œê°„)
test.setTimeout(3600000);



// ë…¹í™” ì„¤ì • í™•ì¸
console.log('ğŸ¬ ì‹œë‚˜ë¦¬ì˜¤ 1 í…ŒìŠ¤íŠ¸ íŒŒì¼ ë¡œë“œë¨');
console.log('ğŸ¬ PLAYWRIGHT_VIDEO_ENABLED:', process.env.PLAYWRIGHT_VIDEO_ENABLED);



// ì „ì²´ ì‹œë‚˜ë¦¬ì˜¤ì˜ ëª¨ë“  ì˜ˆì •ëœ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì •ì˜ (ì‹¤ì œ 39ê°œ)
const allPlannedTestCases = [
  // 1. ì—…ë¬´ì½”ë“œ ë“±ë¡
  { name: 'ì—…ë¬´ì½”ë“œ ë©”ë‰´ ì ‘ê·¼', status: 'pending' },
  { name: 'ì—…ë¬´ì½”ë“œ ë“±ë¡ í™”ë©´ ì—´ê¸°', status: 'pending' },
  { name: 'ì—…ë¬´ì½”ë“œ ì •ë³´ ì…ë ¥', status: 'pending' },
  { name: 'ì˜ë„ì  ì‹¤íŒ¨ í…ŒìŠ¤íŠ¸', status: 'pending' },
  { name: 'ì—…ë¬´ì½”ë“œ ì €ì¥ ë° í™•ì¸', status: 'pending' },
  
  // 2. íˆ´ì²´ì¸ ë“±ë¡
  { name: 'íˆ´ì²´ì¸ ë©”ë‰´ ì ‘ê·¼', status: 'pending' },
  { name: 'íˆ´ì²´ì¸ ë“±ë¡ í™”ë©´ ì—´ê¸°', status: 'pending' },
  { name: 'íˆ´ì²´ì¸ ê¸°ë³¸ ì •ë³´ ì…ë ¥', status: 'pending' },
  { name: 'íˆ´ì²´ì¸ ì €ì¥ ë° í™•ì¸', status: 'pending' },
  
  // 3. ì €ì¥ì†Œ ë“±ë¡
  { name: 'ì €ì¥ì†Œ ë©”ë‰´ ì ‘ê·¼', status: 'pending' },
  { name: 'ì €ì¥ì†Œ ë“±ë¡ í™”ë©´ ì—´ê¸°', status: 'pending' },
  { name: 'ì €ì¥ì†Œ ì •ë³´ ì…ë ¥', status: 'pending' },
  { name: 'ì €ì¥ì†Œ ì €ì¥ ë° í™•ì¸', status: 'pending' },
  { name: 'ë°°ì¹˜ íŒŒì¼ ì‹¤í–‰', status: 'pending' },
  { name: 'GitLab íŒŒì¼ ìˆ˜ì •', status: 'pending' },
  
  // 4. ì‚¬ìš©ì ë“±ë¡ (ì£¼ì„ ì²˜ë¦¬ëœ ë¶€ë¶„ë“¤)
  { name: 'ì‚¬ìš©ì ë©”ë‰´ ì ‘ê·¼', status: 'pending' },
  { name: 'ì‚¬ìš©ì ë“±ë¡ í™”ë©´ ì—´ê¸°', status: 'pending' },
  { name: 'ì‚¬ìš©ì ê¸°ë³¸ ì •ë³´ ì…ë ¥', status: 'pending' },
  { name: 'í‹°ì¼“ ì „ìš© ì—…ë¬´ ë° ì—­í•  ì„¤ì •', status: 'pending' },
  { name: 'ì‚¬ìš©ì ì—…ë¬´ ë° ì—­í•  ì„¤ì •', status: 'pending' },
  { name: 'ì‚¬ìš©ì êµ¬ë¶„ ì„¤ì •', status: 'pending' },
  { name: 'ì‚¬ìš©ì ì €ì¥ ë° í™•ì¸', status: 'pending' },
  
  // 5. ì‚¬ìš©ì ì—…ë¬´ì½”ë“œ ë“±ë¡
  { name: 'ì‚¬ìš©ì ì—…ë¬´ì½”ë“œ ë©”ë‰´ ì ‘ê·¼', status: 'pending' },
  { name: 'ì‚¬ìš©ì ì—…ë¬´ì½”ë“œ ë“±ë¡ í™”ë©´ ì—´ê¸°', status: 'pending' },
  { name: 'ì‚¬ìš©ì ì—…ë¬´ì½”ë“œ ì •ë³´ ì…ë ¥', status: 'pending' },
  { name: 'ì‚¬ìš©ì ì—…ë¬´ì½”ë“œ ì €ì¥ ë° í™•ì¸', status: 'pending' },
  
  // 6. SonarQube ë“±ë¡
  { name: 'SonarQube ë©”ë‰´ ì ‘ê·¼', status: 'pending' },
  { name: 'SonarQube ë“±ë¡ í™”ë©´ ì—´ê¸°', status: 'pending' },
  { name: 'SonarQube ì •ë³´ ì…ë ¥', status: 'pending' },
  { name: 'SonarQube ì €ì¥ ë° í™•ì¸', status: 'pending' },
  
  // 7. JUnit ë“±ë¡
  { name: 'JUnit ë©”ë‰´ ì ‘ê·¼', status: 'pending' },
  { name: 'JUnit ë“±ë¡ í™”ë©´ ì—´ê¸°', status: 'pending' },
  { name: 'JUnit ì •ë³´ ì…ë ¥', status: 'pending' },
  { name: 'JUnit ì €ì¥ ë° í™•ì¸', status: 'pending' },
  
  // 8. íŒŒì´í”„ë¼ì¸ ë“±ë¡
  { name: 'STG íŒŒì´í”„ë¼ì¸ ë“±ë¡', status: 'pending' },
  { name: 'PRD íŒŒì´í”„ë¼ì¸ ë“±ë¡', status: 'pending' },
  
  // 9. ì›Œí¬í”Œë¡œìš° ì»´í¬ë„ŒíŠ¸ ë“±ë¡
  { name: 'ì›Œí¬í”Œë¡œìš° ì»´í¬ë„ŒíŠ¸ ë©”ë‰´ ì ‘ê·¼', status: 'pending' },
  { name: 'ì›Œí¬í”Œë¡œìš° ì»´í¬ë„ŒíŠ¸ ë“±ë¡ í™”ë©´ ì—´ê¸°', status: 'pending' },
  { name: 'ì›Œí¬í”Œë¡œìš° ì»´í¬ë„ŒíŠ¸ ì •ë³´ ì…ë ¥', status: 'pending' },
  { name: 'ì›Œí¬í”Œë¡œìš° ì»´í¬ë„ŒíŠ¸ ì €ì¥ ë° í™•ì¸', status: 'pending' },
  
     // 10. ìƒˆ íƒ­ ë¡œê·¸ì¸ (ì£¼ì„ì²˜ë¦¬)
   // { name: 'ìƒˆ íƒ­ì—ì„œ ë¡œê·¸ì¸', status: 'pending' }
   
  // 11. í‹°ì¼“ ìƒì„± ì„¸ë¶€ ë‹¨ê³„
  { name: 'í‹°ì¼“ ê´€ë¦¬ ë©”ë‰´ ì ‘ê·¼', status: 'pending' },
  { name: 'í‹°ì¼“ ë“±ë¡ í™”ë©´ ì—´ê¸°', status: 'pending' },
  { name: 'í‹°ì¼“ ê¸°ë³¸ ì •ë³´ ì…ë ¥', status: 'pending' },
  { name: 'ì›Œí¬í”Œë¡œìš° ë° ìŠ¹ì¸ ì„¤ì •', status: 'pending' },
  { name: 'ê°œë°œì ë° ë°°í¬ì¼ ì„¤ì •', status: 'pending' },
  { name: 'ë¦´ë¦¬ì¦ˆ ë…¸íŠ¸ ì‘ì„±', status: 'pending' },
  { name: 'ì €ì¥ì†Œ ë° ë¸Œëœì¹˜ ì„ íƒ', status: 'pending' },
  { name: 'í‹°ì¼“ ì €ì¥', status: 'pending' },
  
  // 12. ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤ ì„¸ë¶€ ë‹¨ê³„
  { name: 'ì²« ë²ˆì§¸ ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤', status: 'pending' },
  { name: 'ë‘ ë²ˆì§¸ ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤', status: 'pending' },
  { name: 'ì•Œë¦¼ í™•ì¸', status: 'pending' },
  
  // 13. í‹°ì¼“ ì ‘ê·¼ ë‹¨ê³„
  { name: 'í‹°ì¼“ ì ‘ê·¼', status: 'pending' },
  
  // 13. ì½”ë“œë¦¬ë·° ë‹¨ê³„ ì„¸ë¶€ ë‹¨ê³„ (1~17ë‹¨ê³„ë¥¼ ë…¼ë¦¬ì ìœ¼ë¡œ ê·¸ë£¹í™”)
  { name: 'ì½”ë“œë¦¬ë·° ë‹¨ê³„: ì½”ë“œë¦¬ë·° ì ‘ê·¼', status: 'pending' },        // 1~2ë‹¨ê³„
  { name: 'ì½”ë“œë¦¬ë·° ë‹¨ê³„: ê²€í†  ì˜ê²¬ ì…ë ¥', status: 'pending' },        // 3~7ë‹¨ê³„
  { name: 'ì½”ë“œë¦¬ë·° ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ê´€ë¦¬ ì§„ì…', status: 'pending' },    // 8ë‹¨ê³„
  { name: 'ì½”ë“œë¦¬ë·° ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ë“±ë¡ í™”ë©´ ì§„ì…', status: 'pending' }, // 9ë‹¨ê³„
  { name: 'ì½”ë“œë¦¬ë·° ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì •ë³´ ì…ë ¥', status: 'pending' },     // 10~12ë‹¨ê³„
  { name: 'ì½”ë“œë¦¬ë·° ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì¶”ê°€', status: 'pending' },     // 13~14ë‹¨ê³„
  { name: 'ì½”ë“œë¦¬ë·° ë‹¨ê³„: ì½”ë“œ ê²€í† ', status: 'pending' },             // 15~16ë‹¨ê³„
  { name: 'ì½”ë“œë¦¬ë·° ë‹¨ê³„: ì½”ë“œë¦¬ë·° ë‹¨ê³„ ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„ì…', status: 'pending' },           // 17ë‹¨ê³„
  
  // 14. ì½”ë“œë³‘í•© ë‹¨ê³„ ì„¸ë¶€ ë‹¨ê³„
  { name: 'ì½”ë“œë³‘í•©(STG) ë‹¨ê³„: ì½”ë“œë³‘í•©(STG) ê°€ëŠ¥ í™•ì¸', status: 'pending' },           // ë³‘í•© ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸
  { name: 'ì½”ë“œë³‘í•©(STG) ë‹¨ê³„: ì½”ë“œë³‘í•©(STG) ì§„í–‰', status: 'pending' },               // ë³‘í•© ì™„ë£Œ í™•ì¸
  { name: 'ì½”ë“œë³‘í•©(STG) ë‹¨ê³„: ì½”ë“œë³‘í•©(STG) ë‹¨ê³„ ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„ì…', status: 'pending' }, // ë‹¤ìŒ ë‹¨ê³„ ì§„í–‰
  
  // 15. ë‹¨ìœ„í…ŒìŠ¤íŠ¸ ë‹¨ê³„ ì„¸ë¶€ ë‹¨ê³„
  { name: 'ë‹¨ìœ„í…ŒìŠ¤íŠ¸ ë‹¨ê³„: ë‹¨ìœ„í…ŒìŠ¤íŠ¸ ì§„í–‰', status: 'pending' },             // ë‹¨ìœ„í…ŒìŠ¤íŠ¸ ì„±ê³µ í™•ì¸
  { name: 'ë‹¨ìœ„í…ŒìŠ¤íŠ¸ ë‹¨ê³„: ë‹¨ìœ„í…ŒìŠ¤íŠ¸ ë‹¨ê³„ ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„ì…', status: 'pending' }, // ë‹¤ìŒ ë‹¨ê³„ ì§„í–‰
  
  // 16. ì •ì ë¶„ì„ ë‹¨ê³„ ì„¸ë¶€ ë‹¨ê³„
  { name: 'ì •ì ë¶„ì„ ë‹¨ê³„: ì •ì ë¶„ì„ ì§„í–‰', status: 'pending' },                 // ì •ì ë¶„ì„ ì„±ê³µ í™•ì¸
  { name: 'ì •ì ë¶„ì„ ë‹¨ê³„: ì •ì ë¶„ì„ ë‹¨ê³„ ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„ì…', status: 'pending' }, // ë‹¤ìŒ ë‹¨ê³„ ì§„í–‰
  
  // 9. ìˆ˜ë™ë°°í¬ ë‹¨ê³„
  { name: 'ìˆ˜ë™ë°°í¬(STG) ë‹¨ê³„: ìˆ˜ë™ë°°í¬(STG)', status: 'pending' },
  { name: 'ìˆ˜ë™ë°°í¬(STG) ë‹¨ê³„: ìˆ˜ë™ë°°í¬(STG) ë‹¨ê³„ ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„ì…', status: 'pending' }, // ë‹¤ìŒ ë‹¨ê³„ ì§„í–‰
  
  // 10. í†µí•©í…ŒìŠ¤íŠ¸ ë‹¨ê³„
  { name: 'í†µí•©í…ŒìŠ¤íŠ¸ ë‹¨ê³„: í†µí•©í…ŒìŠ¤íŠ¸ íŒŒì¼ ì—…ë¡œë“œ', status: 'pending' },
  { name: 'í†µí•©í…ŒìŠ¤íŠ¸ ë‹¨ê³„: í†µí•©í…ŒìŠ¤íŠ¸ ë‹¨ê³„ ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„ì…', status: 'pending' }, // ë‹¤ìŒ ë‹¨ê³„ ì§„í–‰
  
  // 11. ì½”ë“œë³‘í•©(PRD) ë‹¨ê³„
  { name: 'ì½”ë“œë³‘í•©(PRD) ë‹¨ê³„: ì½”ë“œë³‘í•©(PRD) ê°€ëŠ¥ í™•ì¸', status: 'pending' },
  { name: 'ì½”ë“œë³‘í•©(PRD) ë‹¨ê³„: ì½”ë“œë³‘í•©(PRD) ì§„í–‰', status: 'pending' },
  { name: 'ì½”ë“œë³‘í•©(PRD) ë‹¨ê³„: ì½”ë“œë³‘í•©(PRD) ë‹¨ê³„ ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„ì…', status: 'pending' }, // ë‹¤ìŒ ë‹¨ê³„ ì§„í–‰
  
  // 12. ìˆ˜ë™ë°°í¬(PRD) ë‹¨ê³„
  { name: 'ìˆ˜ë™ë°°í¬(PRD) ë‹¨ê³„: ìˆ˜ë™ë°°í¬(PRD)', status: 'pending' },
  { name: 'ìˆ˜ë™ë°°í¬(PRD) ë‹¨ê³„: ìˆ˜ë™ë°°í¬(PRD) ë‹¨ê³„ ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„ì…', status: 'pending' }, // ë‹¤ìŒ ë‹¨ê³„ ì§„í–‰
  
  // 13. í‹°ì¼“ ì¢…ë£Œ ë‹¨ê³„
  { name: 'í‹°ì¼“ ì¢…ë£Œ ë‹¨ê³„: í‹°ì¼“ ì¢…ë£Œ', status: 'pending' }
];

// í…ŒìŠ¤íŠ¸ ê²°ê³¼ë¥¼ ì €ì¥í•  ê°ì²´ (ëª¨ë“  ì˜ˆì •ëœ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¡œ ì´ˆê¸°í™”)
const testResults = {
  status: 'pass',
  error: null,
  testCases: allPlannedTestCases.map(tc => ({
    name: tc.name,
    status: tc.status,
    startTime: null,
    endTime: null,
    error: null,
    duration: 0,
    logs: []
  })),
  startTime: new Date().toISOString(),
  endTime: null,
  duration: '0ë¶„'
};

// í…ŒìŠ¤íŠ¸ ë‹¨ê³„ë¥¼ ì‹¤í–‰í•˜ê³  ê²°ê³¼ë¥¼ ê¸°ë¡í•˜ëŠ” í•¨ìˆ˜
async function runTestStep(stepName, action, page) {
  // ê¸°ì¡´ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ì°¾ì•„ì„œ ì—…ë°ì´íŠ¸
  let testCase = testResults.testCases.find(tc => tc.name === stepName);
  if (!testCase) {
    // ì˜ˆìƒí•˜ì§€ ëª»í•œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¼ë©´ ìƒˆë¡œ ì¶”ê°€
    testCase = {
      name: stepName,
      status: 'pending',
      startTime: null,
      endTime: null,
      error: null,
      duration: 0,
      logs: [],
      screenshots: [] // ìŠ¤í¬ë¦°ìƒ· ë°°ì—´ ì¶”ê°€
    };
    testResults.testCases.push(testCase);
  }
  
  // í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‹œì‘
  testCase.status = 'pending';
  testCase.startTime = new Date().toISOString();
  testCase.error = null;
  testCase.logs = [];  // ë¡œê·¸ ì´ˆê¸°í™”
  testCase.screenshots = []; // ìŠ¤í¬ë¦°ìƒ· ì´ˆê¸°í™”

  // ë¡œê·¸ ìº¡ì²˜ í•¨ìˆ˜
  const captureLog = (type, message) => {
    const timestamp = new Date().toISOString();
    testCase.logs.push({ timestamp, type, message });
    
    // ë¡œê·¸ ë©”ì‹œì§€ ìƒì„±
    const logPrefix = type === 'error' ? 'âŒ' : type === 'success' ? 'âœ…' : type === 'warning' ? 'âš ï¸' : 'â„¹ï¸';
    const logMessage = `${logPrefix} ${stepName}: ${message}`;
    
    // process.stdout.writeë§Œ ì‚¬ìš©í•˜ì—¬ ì¤‘ë³µ ì¶œë ¥ ë°©ì§€
    process.stdout.write(logMessage + '\n');
  };

  // ìŠ¤í¬ë¦°ìƒ· ìº¡ì²˜ í•¨ìˆ˜ - ë‹¨ê³„ ì™„ë£Œ í›„ 1ê°œë§Œ ìº¡ì²˜í•˜ê³  ì™„ë£Œê¹Œì§€ ëŒ€ê¸°
  const captureScreenshot = async (suffix = '') => {
    if (!page) {
      captureLog('warning', 'í˜ì´ì§€ ê°ì²´ê°€ ì—†ì–´ ìŠ¤í¬ë¦°ìƒ·ì„ ì°ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
      return;
    }
    
    try {
      captureLog('info', `ğŸ“¸ ${stepName} ë‹¨ê³„ ì™„ë£Œ ìŠ¤í¬ë¦°ìƒ· ì´¬ì˜ ì¤‘...`);
      
      const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
      const fileName = suffix ? `screenshot-${stepName}-${suffix}-${timestamp}.png` : `screenshot-${stepName}-${timestamp}.png`;
      const screenshotDir = path.join(__dirname, '../../custom-reports/scenario-1');
      const screenshotPath = path.join(screenshotDir, fileName);
      
      // ë””ë ‰í† ë¦¬ê°€ ì—†ìœ¼ë©´ ìƒì„±
      if (!fs.existsSync(screenshotDir)) {
        fs.mkdirSync(screenshotDir, { recursive: true });
        captureLog('info', `ğŸ“ ìŠ¤í¬ë¦°ìƒ· ë””ë ‰í† ë¦¬ ìƒì„±: ${screenshotDir}`);
      }
      
      // ìŠ¤í¬ë¦°ìƒ· ì°ê¸° (ì™„ë£Œê¹Œì§€ ëŒ€ê¸°)
      await page.screenshot({ 
        path: screenshotPath, 
        fullPage: true 
      });
      
      // íŒŒì¼ì´ ì‹¤ì œë¡œ ìƒì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸
      if (fs.existsSync(screenshotPath)) {
        const stats = fs.statSync(screenshotPath);
        captureLog('success', `ğŸ“¸ ${stepName} ë‹¨ê³„ ì™„ë£Œ ìŠ¤í¬ë¦°ìƒ· ì €ì¥ ì™„ë£Œ: ${fileName} (í¬ê¸°: ${stats.size} bytes)`);
        
        // ìƒëŒ€ ê²½ë¡œë¡œ ì €ì¥ (ë¦¬í¬íŠ¸ì—ì„œ ì°¸ì¡°í•  ê²½ë¡œ)
        const relativePath = `./${fileName}`;
        testCase.screenshots = [relativePath]; // ë°°ì—´ì„ ìƒˆë¡œ í• ë‹¹í•˜ì—¬ 1ê°œë§Œ ìœ ì§€
      } else {
        captureLog('error', `ğŸ“¸ ìŠ¤í¬ë¦°ìƒ· íŒŒì¼ì´ ìƒì„±ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤: ${screenshotPath}`);
      }
    } catch (error) {
      captureLog('error', `ìŠ¤í¬ë¦°ìƒ· ì €ì¥ ì‹¤íŒ¨: ${error.message}`);
    }
  };

  captureLog('info', `ğŸ“ ${stepName} ì‹œì‘...`);
  const startTime = new Date();
  
  try {
    await action();
    
    // ìŠ¤í¬ë¦°ìƒ· ìº¡ì²˜ ì „ 1ì´ˆ ëŒ€ê¸° (UI ì•ˆì •í™”ë¥¼ ìœ„í•´)
    captureLog('info', `â³ UI ì•ˆì •í™”ë¥¼ ìœ„í•´ 1ì´ˆ ëŒ€ê¸° ì¤‘...`);
    await new Promise(resolve => setTimeout(resolve, 1000));
    
    testCase.status = 'pass';
    captureLog('success', `âœ… ${stepName} ì„±ê³µ`);
    
    // í…ŒìŠ¤íŠ¸ ì„±ê³µ í›„ ë‹¨ê³„ ì™„ë£Œ ìŠ¤í¬ë¦°ìƒ· (ì™„ë£Œê¹Œì§€ ëŒ€ê¸°)
    await captureScreenshot();
    
  } catch (error) {
    // ìˆ˜ë™ìœ¼ë¡œ ë‹«íŒ í…ŒìŠ¤íŠ¸ì¸ì§€ í™•ì¸ (ë¸Œë¼ìš°ì € ê°•ì œì¢…ë£Œë‚˜ ì¤‘ë‹¨ ë²„íŠ¼)
    const isManuallyClosed = global.manuallyClosedTests && global.manuallyClosedTests.has('scenario-1');
    
    testCase.status = 'fail';
    testCase.error = error;
    testResults.status = 'fail';
    testResults.error = error;
    
    if (isManuallyClosed) {
      captureLog('error', `âŒ ${stepName} ìˆ˜ë™ ì¤‘ë‹¨: ${error.message}`);
    } else {
      captureLog('error', `âŒ ${stepName} ì‹¤íŒ¨: ${error.message}`);
    }
    
    // ì‹¤íŒ¨í•˜ëŠ” ìˆœê°„ ì¦‰ì‹œ ìŠ¤í¬ë¦°ìƒ· ìº¡ì²˜ (UI ì•ˆì •í™”ë¥¼ ìœ„í•´ 0.5ì´ˆë§Œ ëŒ€ê¸°)
    captureLog('info', `â³ ì‹¤íŒ¨ ìƒíƒœ ìº¡ì²˜ë¥¼ ìœ„í•´ 0.5ì´ˆ ëŒ€ê¸° ì¤‘...`);
    await new Promise(resolve => setTimeout(resolve, 500));
    
    // í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ìˆœê°„ ìŠ¤í¬ë¦°ìƒ· (ì™„ë£Œê¹Œì§€ ëŒ€ê¸°)
    await captureScreenshot('ì‹¤íŒ¨');
    
    // ì´í›„ ëª¨ë“  í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ not-testë¡œ í‘œì‹œí•˜ê³  ìŠ¤í¬ë¦°ìƒ· ì´ˆê¸°í™”
    testResults.testCases.forEach(tc => {
      if (tc.status === 'pending') {
        tc.status = 'not-test';
        if (isManuallyClosed) {
          tc.error = new Error('í…ŒìŠ¤íŠ¸ ìˆ˜ë™ ì¤‘ë‹¨ìœ¼ë¡œ ì¸í•´ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ');
        } else {
          tc.error = new Error('ì´ì „ ë‹¨ê³„ ì‹¤íŒ¨ë¡œ ì¸í•´ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ');
        }
        tc.logs.push({
          timestamp: new Date().toISOString(),
          type: 'error',
          message: isManuallyClosed ? 'í…ŒìŠ¤íŠ¸ ìˆ˜ë™ ì¤‘ë‹¨ìœ¼ë¡œ ì¸í•´ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ' : 'ì´ì „ ë‹¨ê³„ ì‹¤íŒ¨ë¡œ ì¸í•´ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ'
        });
        tc.screenshots = []; // ì‹¤í–‰ë˜ì§€ ì•Šì€ ë‹¨ê³„ëŠ” ìŠ¤í¬ë¦°ìƒ· ì—†ìŒ
      }
    });
    
    throw error;
  } finally {
    testCase.endTime = new Date().toISOString();
    const endTime = new Date();
    const duration = endTime - startTime;
    testCase.duration = duration;
    captureLog('info', `â±ï¸ ${stepName} ì†Œìš”ì‹œê°„: ${duration}ms`);
  }
}

// ë§¤ë‹ˆì € í´ë˜ìŠ¤ë“¤ import
// import UserManager from '../../lib/classes/UserManager.js';

// ì„¤ì • íŒŒì¼ì—ì„œ ë°ì´í„°ë¥¼ ì½ì–´ì˜¤ëŠ” í•¨ìˆ˜ (ì‹œë‚˜ë¦¬ì˜¤ë³„)
function loadTestSettings() {
  const scenarioId = 1; // í˜„ì¬ ì‹œë‚˜ë¦¬ì˜¤ ID
  const configPath = path.join(__dirname, `../../config/scenario/test-settings-${scenarioId}.json`);
  
  // ì‹œë‚˜ë¦¬ì˜¤ë³„ ì„¤ì • íŒŒì¼ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
  if (fs.existsSync(configPath)) {
    const config = JSON.parse(fs.readFileSync(configPath, 'utf8'));
    // ë™ì ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ê°’ë“¤
    config.repository.group = config.project.code;
    return config;
  } else {
    // ì‹œë‚˜ë¦¬ì˜¤ë³„ ì„¤ì • íŒŒì¼ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ ì„¤ì • íŒŒì¼ ì‚¬ìš©
    const defaultConfigPath = path.join(__dirname, '../../config/test-settings.json');
    const config = JSON.parse(fs.readFileSync(defaultConfigPath, 'utf8'));
    // ë™ì ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ê°’ë“¤
    config.repository.group = config.project.code;
    return config;
  }
}

// íŒŒì´í”„ë¼ì¸ í…œí”Œë¦¿ì—ì„œ ë™ì ìœ¼ë¡œ ë‚´ìš©ì„ ìƒì„±í•˜ëŠ” í•¨ìˆ˜
async function generatePipelineContent(templatePath, taskCode) {
  try {
    console.log(`ğŸ”„ íŒŒì´í”„ë¼ì¸ ë‚´ìš© ìƒì„±: ${templatePath} - ì—…ë¬´ì½”ë“œ ${taskCode}`);
    
    // í…œí”Œë¦¿ íŒŒì¼ ì½ê¸°
    const templateContent = fs.readFileSync(templatePath, 'utf8');
    
    // í”Œë ˆì´ìŠ¤í™€ë” ì¹˜í™˜
    let generatedContent = templateContent.replace(/\$\{ì—…ë¬´ì½”ë“œ\}/g, taskCode);
    generatedContent = generatedContent.replace(/\$\{ì—…ë¬´ì½”ë“œ\}-REPO/g, `${taskCode}-REPO`);
    
    console.log(`âœ… íŒŒì´í”„ë¼ì¸ ë‚´ìš© ìƒì„± ì™„ë£Œ: ${taskCode}/${taskCode}-REPO`);
    return generatedContent;
    
  } catch (error) {
    console.log('âŒ íŒŒì´í”„ë¼ì¸ ë‚´ìš© ìƒì„± ì‹¤íŒ¨:', error.message);
    throw error;
  }
}

// ë°°ì¹˜ íŒŒì¼ì„ ì‹¤í–‰í•˜ëŠ” í•¨ìˆ˜
async function executeBatchFile(taskCode) {
  try {
    console.log(`ğŸ”„ ë°°ì¹˜ íŒŒì¼ ì‹¤í–‰: ì—…ë¬´ì½”ë“œ ${taskCode}`);
    
    const { spawn } = await import('child_process');
    const batchFilePath = path.join(__dirname, '../../scripts/push-files-to-repo.bat');
    
    // ë°°ì¹˜ íŒŒì¼ ì¡´ì¬ í™•ì¸
    if (!fs.existsSync(batchFilePath)) {
      throw new Error(`ë°°ì¹˜ íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤: ${batchFilePath}`);
    }
    
    console.log(`ğŸ“ ë°°ì¹˜ íŒŒì¼ ê²½ë¡œ: ${batchFilePath}`);
    console.log(`ğŸ“‹ ì‹¤í–‰ ë§¤ê°œë³€ìˆ˜: ${taskCode}`);
    
    return new Promise((resolve, reject) => {
      // ë°°ì¹˜ íŒŒì¼ ì‹¤í–‰
      const child = spawn('cmd', ['/c', batchFilePath, taskCode], {
        stdio: ['pipe', 'pipe', 'pipe'],
        shell: true
      });
      
      let stdout = '';
      let stderr = '';
      
      // stdout ì²˜ë¦¬
      child.stdout.on('data', (data) => {
        const output = data.toString();
        stdout += output;
        console.log(`ğŸ“¤ [BATCH] ${output.trim()}`);
      });
      
      // stderr ì²˜ë¦¬
      child.stderr.on('data', (data) => {
        const output = data.toString();
        stderr += output;
        console.log(`ğŸ“¤ [BATCH-ERROR] ${output.trim()}`);
      });
      
      // í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ ì²˜ë¦¬
      child.on('close', (code) => {
        if (code === 0) {
          console.log(`âœ… ë°°ì¹˜ íŒŒì¼ ì‹¤í–‰ ì„±ê³µ (ì¢…ë£Œ ì½”ë“œ: ${code})`);
          resolve({ success: true, code, stdout, stderr });
        } else {
          console.log(`âŒ ë°°ì¹˜ íŒŒì¼ ì‹¤í–‰ ì‹¤íŒ¨ (ì¢…ë£Œ ì½”ë“œ: ${code})`);
          reject(new Error(`ë°°ì¹˜ íŒŒì¼ ì‹¤í–‰ ì‹¤íŒ¨ (ì¢…ë£Œ ì½”ë“œ: ${code})\nSTDOUT: ${stdout}\nSTDERR: ${stderr}`));
        }
      });
      
      // í”„ë¡œì„¸ìŠ¤ ì˜¤ë¥˜ ì²˜ë¦¬
      child.on('error', (error) => {
        console.log(`âŒ ë°°ì¹˜ íŒŒì¼ ì‹¤í–‰ ì˜¤ë¥˜: ${error.message}`);
        reject(error);
      });
      
      // íƒ€ì„ì•„ì›ƒ ì„¤ì • (5ë¶„)
      setTimeout(() => {
        child.kill();
        reject(new Error('ë°°ì¹˜ íŒŒì¼ ì‹¤í–‰ íƒ€ì„ì•„ì›ƒ (5ë¶„)'));
      }, 5 * 60 * 1000);
    });
    
  } catch (error) {
    console.log('âŒ ë°°ì¹˜ íŒŒì¼ ì‹¤í–‰ ì‹¤íŒ¨:', error.message);
    throw error;
  }
}

// ë§¤ë‹ˆì € í´ë˜ìŠ¤ë“¤ì„ ì´ˆê¸°í™”í•˜ëŠ” í•¨ìˆ˜
function initializeManagers(page) {
  const tromboneUtils = new utils(page);
  
  return {
    utils: tromboneUtils,
    taskCodeManager: new TaskCodeManager(tromboneUtils),
    toolchainManager: new ToolchainManager(tromboneUtils),
    repositoryManager: new RepositoryManager(tromboneUtils),
    // userManager: new UserManager(tromboneUtils),
    userTaskCodeManager: new UserTaskCodeManager(tromboneUtils),
    sonarQubeManager: new SonarQubeManager(tromboneUtils),
    jUnitManager: new JUnitManager(tromboneUtils),
    pipelineManager: new PipelineManager(tromboneUtils),
    workflowComponentManager: new WorkflowComponentManager(tromboneUtils),
    loginManager: new LoginManager(page),
    ticketCreateManager: new TicketCreateManager(tromboneUtils),
    ticketApproachManager: new TicketApproachManager(tromboneUtils),
    ticketApproval: new TicketApproval(tromboneUtils),
    gitlabManager: new GitLabManager(page),
    approvalManager: new ApprovalManager(tromboneUtils),
    ticketCodeReviewManager: new TicketCodeReviewManager(tromboneUtils),
    ticketCodeMergeSTGManager: new TicketCodeMergeSTGManager(tromboneUtils),
    ticketCodeMergePRDManager: new TicketCodeMergePRDManager(tromboneUtils),
    ticketUnitTestManager: new TicketUnitTestManager(tromboneUtils),
    ticketManualDeploymentSTGManager: new TicketManualDeploymentSTGManager(tromboneUtils),
    ticketManualDeploymentPRDManager: new TicketManualDeploymentPRDManager(tromboneUtils),
    ticketIntegrationTestManager: new TicketIntegrationTestManager(tromboneUtils),
    ticketDeploymentInformationManager: new TicketDeploymentInformationManager(tromboneUtils),
    ticketStaticAnalysisManager: new TicketStaticAnalysisManager(tromboneUtils)
  };
}

// ì‹œë‚˜ë¦¬ì˜¤ 1: CI/CD ì¼ë°˜ í‹°ì¼“ì„ í†µí•œ K8S ë°°í¬ ì‹œë‚˜ë¦¬ì˜¤ (ì˜ˆì•½ ë°°í¬ / ì§ë ¬ ê²°ì¬)
test.describe.serial('ì‹œë‚˜ë¦¬ì˜¤ 1: CI/CD ì¼ë°˜ í‹°ì¼“ì„ í†µí•œ K8S ë°°í¬ ì‹œë‚˜ë¦¬ì˜¤', () => {
  let page;
  let browser;
  let config;
  let managers;

  // í…ŒìŠ¤íŠ¸ ì‹œì‘ ì „ í•œ ë²ˆë§Œ ì‹¤í–‰ - ë¡œê·¸ì¸ ë° ì´ˆê¸° ì„¤ì •
  test.beforeAll(async ({ browser: browserInstance }) => {
    browser = browserInstance;
    // í…ŒìŠ¤íŠ¸ ì‹œì‘ì„ ëª…í™•í•˜ê²Œ í‘œì‹œ
    console.log('ğŸš€ ì‹œë‚˜ë¦¬ì˜¤ 1 í…ŒìŠ¤íŠ¸ ì‹œì‘');
    process.stdout.write('ğŸš€ ì‹œë‚˜ë¦¬ì˜¤ 1 í…ŒìŠ¤íŠ¸ ì‹œì‘\n');
    
    console.log('ğŸ“‹ ì„¤ì • íŒŒì¼ ë¡œë“œ ì¤‘...');
    process.stdout.write('ğŸ“‹ ì„¤ì • íŒŒì¼ ë¡œë“œ ì¤‘...\n');
    
    config = loadTestSettings();
    console.log('âœ… ì„¤ì • íŒŒì¼ ë¡œë“œ ì™„ë£Œ');
    
    // ìŠ¤í¬ë¦°ìƒ· ë””ë ‰í† ë¦¬ ìƒì„± (ì—†ìœ¼ë©´)
    const screenshotDir = path.join(__dirname, '../../custom-reports/scenario-1');
    if (!fs.existsSync(screenshotDir)) {
      fs.mkdirSync(screenshotDir, { recursive: true });
    }
    
    // ë¸Œë¼ìš°ì € ì¸ìŠ¤í„´ìŠ¤ ì €ì¥
    browser = browserInstance;
    
    // ë…¹í™” ì„¤ì • í™•ì¸
    const recordingSettingsPath = path.join(__dirname, '../../config/recording-settings.json');
    let isRecordingEnabled = false;
    
    if (fs.existsSync(recordingSettingsPath)) {
      try {
        const recordingSettings = JSON.parse(fs.readFileSync(recordingSettingsPath, 'utf8'));
        isRecordingEnabled = recordingSettings['1'] || false;
        console.log(`ğŸ¬ ì‹œë‚˜ë¦¬ì˜¤ 1 ë…¹í™” ì„¤ì •: ${isRecordingEnabled ? 'í™œì„±í™”' : 'ë¹„í™œì„±í™”'}`);
      } catch (error) {
        console.log(`âš ï¸ ë…¹í™” ì„¤ì • ì½ê¸° ì‹¤íŒ¨, ê¸°ë³¸ê°’ ì‚¬ìš©: ${error.message}`);
      }
    }
    
    // ë…¹í™” ì„¤ì •ì— ë”°ë¼ ë¸Œë¼ìš°ì € ì»¨í…ìŠ¤íŠ¸ ìƒì„±
    let context;
    if (isRecordingEnabled) {
      context = await browser.newContext({
        recordVideo: {
          dir: 'test-results/videos/',
          size: { width: 1280, height: 720 }
        }
      });
      console.log('ğŸ¬ ë…¹í™”ê°€ í™œì„±í™”ë˜ì–´ ë¸Œë¼ìš°ì € ì»¨í…ìŠ¤íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.');
    } else {
      context = await browser.newContext();
      console.log('ğŸ¬ ë…¹í™”ê°€ ë¹„í™œì„±í™”ë˜ì–´ ì¼ë°˜ ë¸Œë¼ìš°ì € ì»¨í…ìŠ¤íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.');
    }
    
    // ë¸Œë¼ìš°ì € í˜ì´ì§€ ìƒì„±
    page = await context.newPage();
    
    // í¬ì»¤ì‹± ë¬¸ì œ í•´ê²°: í˜ì´ì§€ ë¡œë“œ í›„ ë¸Œë¼ìš°ì € ì°½ì— í¬ì»¤ìŠ¤ ë§ì¶”ê¸°
    if (isRecordingEnabled) {
      console.log('ğŸ¯ ë…¹í™”ë¥¼ ìœ„í•œ ë¸Œë¼ìš°ì € í¬ì»¤ì‹± ì„¤ì • ì¤‘...');
      await page.bringToFront();
      await page.waitForTimeout(2000); // í¬ì»¤ì‹± ì•ˆì •í™”ë¥¼ ìœ„í•œ ëŒ€ê¸°
      console.log('ğŸ¯ ë¸Œë¼ìš°ì € í¬ì»¤ì‹± ì™„ë£Œ');
    }
    
    // ë§¤ë‹ˆì € í´ë˜ìŠ¤ë“¤ ì´ˆê¸°í™”
    console.log('ğŸ”§ ë§¤ë‹ˆì € í´ë˜ìŠ¤ ì´ˆê¸°í™” ì¤‘...');
    managers = initializeManagers(page);
    console.log('âœ… ë§¤ë‹ˆì € í´ë˜ìŠ¤ ì´ˆê¸°í™” ì™„ë£Œ');
    
    // GitLab ë§¤ë‹ˆì €ëŠ” initializeManagersì—ì„œ ì´ˆê¸°í™”ë¨
    console.log('âœ… GitLab ë§¤ë‹ˆì € ì´ˆê¸°í™” ì™„ë£Œ');
  });

  // í…ŒìŠ¤íŠ¸ ì¢…ë£Œ í›„ ì •ë¦¬
  test.afterAll(async () => {
    // ë…¹í™” ì„¤ì • í™•ì¸
    const recordingSettingsPath = path.join(__dirname, '../../config/recording-settings.json');
    let isRecordingEnabled = false;
    
    if (fs.existsSync(recordingSettingsPath)) {
      try {
        const recordingSettings = JSON.parse(fs.readFileSync(recordingSettingsPath, 'utf8'));
        isRecordingEnabled = recordingSettings['1'] || false;
      } catch (error) {
        console.log(`âš ï¸ ë…¹í™” ì„¤ì • ì½ê¸° ì‹¤íŒ¨: ${error.message}`);
      }
    }
    
    // ë…¹í™” ì»¨í…ìŠ¤íŠ¸ ë‹«ê¸°
    if (page) {
      await page.context().close();
    }
    
    // ë…¹í™”ê°€ í™œì„±í™”ëœ ê²½ìš°ì—ë§Œ ë…¹í™” íŒŒì¼ ì²˜ë¦¬
    if (isRecordingEnabled) {
      console.log('ğŸ¬ ë…¹í™”ê°€ í™œì„±í™”ë˜ì–´ ë…¹í™” íŒŒì¼ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.');
      
      // âš ï¸ ë³‘ë ¬ ì‹¤í–‰ ëŒ€ë¹„: Playwrightì˜ page.video().path()ë¡œ ì •í™•í•œ ë¹„ë””ì˜¤ íŒŒì¼ ê²½ë¡œ ê°€ì ¸ì˜¤ê¸°
      try {
        const videoPath = await page.video()?.path();
        
        if (videoPath && fs.existsSync(videoPath)) {
          console.log(`ğŸ“¹ [ì‹œë‚˜ë¦¬ì˜¤ 1] Playwright ë¹„ë””ì˜¤ ê²½ë¡œ: ${videoPath}`);
          
          const stats = fs.statSync(videoPath);
          const videoDir = path.dirname(videoPath);
          const oldFileName = path.basename(videoPath);
          
          // íŒŒì¼ ìƒì„± ì‹œê°„ì„ ëŒ€í•œë¯¼êµ­ ì‹œê°„ìœ¼ë¡œ ë³€í™˜
          const koreaTime = new Date(stats.birthtime).toLocaleString('ko-KR', {
            timeZone: 'Asia/Seoul',
            year: 'numeric',
            month: '2-digit',
            day: '2-digit',
            hour: '2-digit',
            minute: '2-digit',
            second: '2-digit',
            hour12: false
          }).replace(/[\/\s:]/g, '-');
          
          // ì œí’ˆëª… ì¶”ì¶œ
          const productName = path.basename(path.dirname(path.dirname(__dirname))).toUpperCase();
          const scenarioId = '1';
          const newFileName = `${productName}-scenario-${scenarioId}-${koreaTime}.webm`;
          const newPath = path.join(videoDir, newFileName);
          
          // íŒŒì¼ëª… ë³€ê²½
          fs.renameSync(videoPath, newPath);
          console.log(`ğŸ“¹ ë…¹í™” íŒŒì¼ëª… ë³€ê²½: ${oldFileName} â†’ ${newFileName}`);
          
          // ì‚¬ìš©ì ì§€ì • ë…¹í™” ì €ì¥ ê²½ë¡œì— ë³µì‚¬ í™•ì¸
          try {
            const userRecordingSettingsPath = path.join(__dirname, '../../config/user-recording-folders.json');
            if (fs.existsSync(userRecordingSettingsPath)) {
              const userRecordingFolders = JSON.parse(fs.readFileSync(userRecordingSettingsPath, 'utf8'));
              const userFolderPath = userRecordingFolders['1']; // ì‹œë‚˜ë¦¬ì˜¤ 1ì˜ ë…¹í™” í´ë”
              
              if (userFolderPath && fs.existsSync(userFolderPath)) {
                const userRecordingPath = path.join(userFolderPath, newFileName);
                
                // íŒŒì¼ ë³µì‚¬
                fs.copyFileSync(newPath, userRecordingPath);
                console.log(`ğŸ“¹ ì‚¬ìš©ì ì§€ì • ê²½ë¡œì— ë…¹í™” íŒŒì¼ ë³µì‚¬ ì™„ë£Œ: ${userRecordingPath}`);
                
                // ë³µì‚¬ëœ íŒŒì¼ í™•ì¸
                if (fs.existsSync(userRecordingPath)) {
                  const userFileStats = fs.statSync(userRecordingPath);
                  console.log(`âœ… ì‚¬ìš©ì ì§€ì • ê²½ë¡œ ë…¹í™” íŒŒì¼ í™•ì¸ ì™„ë£Œ:`);
                  console.log(`   - ê²½ë¡œ: ${userRecordingPath}`);
                  console.log(`   - í¬ê¸°: ${(userFileStats.size / 1024 / 1024).toFixed(2)} MB`);
                  console.log(`   - ìˆ˜ì •ì‹œê°„: ${userFileStats.mtime.toLocaleString('ko-KR', { timeZone: 'Asia/Seoul' })}`);
                } else {
                  console.log(`âŒ ì‚¬ìš©ì ì§€ì • ê²½ë¡œì— ë…¹í™” íŒŒì¼ ë³µì‚¬ ì‹¤íŒ¨`);
                }
              } else {
                console.log(`âš ï¸ ì‚¬ìš©ì ì§€ì • ë…¹í™” í´ë”ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŒ: ${userFolderPath}`);
              }
            } else {
              console.log(`âš ï¸ ì‚¬ìš©ì ë…¹í™” í´ë” ì„¤ì • íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŒ: ${userRecordingSettingsPath}`);
            }
          } catch (copyError) {
            console.log(`âš ï¸ ì‚¬ìš©ì ì§€ì • ê²½ë¡œ ë³µì‚¬ ì¤‘ ì˜¤ë¥˜: ${copyError.message}`);
          }
        } else {
          console.log(`âš ï¸ [ì‹œë‚˜ë¦¬ì˜¤ 1] ë…¹í™” íŒŒì¼ ê²½ë¡œë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`);
        }
      } catch (error) {
        console.log(`âš ï¸ ë…¹í™” íŒŒì¼ëª… ë³€ê²½ ì¤‘ ì˜¤ë¥˜: ${error.message}`);
      }
    } else {
      console.log('ğŸ¬ ë…¹í™”ê°€ ë¹„í™œì„±í™”ë˜ì–´ ë…¹í™” íŒŒì¼ ì²˜ë¦¬ë¥¼ ê±´ë„ˆëœë‹ˆë‹¤.');
    }
    
    testResults.endTime = new Date().toISOString();
    const duration = new Date(testResults.endTime) - new Date(testResults.startTime);
    testResults.duration = `${Math.round(duration / 1000 / 60)}ë¶„`;

    // ìˆ˜ë™ìœ¼ë¡œ ë‹«íŒ í…ŒìŠ¤íŠ¸ì¸ì§€ í™•ì¸ (ë¸Œë¼ìš°ì € ê°•ì œì¢…ë£Œë‚˜ ì¤‘ë‹¨ ë²„íŠ¼)
    const isManuallyClosed = global.manuallyClosedTests && global.manuallyClosedTests.has('scenario-1');
    if (isManuallyClosed) {
      console.log('âš ï¸ í…ŒìŠ¤íŠ¸ê°€ ìˆ˜ë™ìœ¼ë¡œ ì¤‘ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤ (ë¸Œë¼ìš°ì € ê°•ì œì¢…ë£Œ ë˜ëŠ” ì¤‘ë‹¨ ë²„íŠ¼).');
      testResults.status = 'fail';
      testResults.error = new Error('í…ŒìŠ¤íŠ¸ê°€ ìˆ˜ë™ìœ¼ë¡œ ì¤‘ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤.');
      
      // ëª¨ë“  pending ìƒíƒœì˜ í…ŒìŠ¤íŠ¸ë¥¼ not-testë¡œ í‘œì‹œ
      testResults.testCases.forEach(tc => {
        if (tc.status === 'pending') {
          tc.status = 'not-test';
          tc.error = new Error('í…ŒìŠ¤íŠ¸ ìˆ˜ë™ ì¤‘ë‹¨ìœ¼ë¡œ ì¸í•´ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ');
          tc.endTime = new Date().toISOString();
        }
      });
    }
    
    // í…ŒìŠ¤íŠ¸ ì¤‘ë‹¨ ì—¬ë¶€ í™•ì¸ (ì¼ë°˜ì ì¸ ì¤‘ë‹¨)
    const isTestInterrupted = testResults.testCases.some(tc => tc.status === 'pending');
    if (isTestInterrupted && !isManuallyClosed) {
      console.log('âš ï¸ í…ŒìŠ¤íŠ¸ê°€ ì¤‘ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤.');
      testResults.status = 'fail';
      testResults.error = new Error('í…ŒìŠ¤íŠ¸ê°€ ì¤‘ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤.');
      
      // ëª¨ë“  pending ìƒíƒœì˜ í…ŒìŠ¤íŠ¸ë¥¼ not-testë¡œ í‘œì‹œ
      testResults.testCases.forEach(tc => {
        if (tc.status === 'pending') {
          tc.status = 'not-test';
          tc.error = new Error('í…ŒìŠ¤íŠ¸ ì¤‘ë‹¨ìœ¼ë¡œ ì¸í•´ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ');
          tc.endTime = new Date().toISOString();
        }
      });
    }

    // ê²°ê³¼ë¥¼ íŒŒì¼ì— ì €ì¥
    const resultPath = path.join(__dirname, '../../custom-reports/global-test-results.json');
    try {
      let allResults = {};
      if (fs.existsSync(resultPath)) {
        allResults = JSON.parse(fs.readFileSync(resultPath, 'utf8'));
      }
      allResults['scenario-1'] = testResults;
      fs.writeFileSync(resultPath, JSON.stringify(allResults, null, 2));
      
      console.log('ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼ ìš”ì•½:');
      console.log(`- ì´ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤: ${testResults.testCases.length}`);
      console.log(`- ì„±ê³µ: ${testResults.testCases.filter(tc => tc.status === 'pass').length}`);
      console.log(`- ì‹¤íŒ¨: ${testResults.testCases.filter(tc => tc.status === 'fail').length}`);
      console.log(`- NOT TEST: ${testResults.testCases.filter(tc => tc.status === 'not-test').length}`);
      console.log(`- ì „ì²´ ìƒíƒœ: ${testResults.status}`);
      if (testResults.error) {
        console.log(`- ì˜¤ë¥˜: ${testResults.error.message}`);
      }

      // ë””ë²„ê·¸: ëª¨ë“  í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ìƒíƒœ ì¶œë ¥
      console.log('ğŸ“‹ ëª¨ë“  í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤:');
      testResults.testCases.forEach((tc, index) => {
        console.log(`  ${index + 1}. ${tc.name} - ${tc.status}`);
      });

      // ì»¤ìŠ¤í…€ HTML ë¦¬í¬íŠ¸ëŠ” main.jsì—ì„œ ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤.
      console.log('ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼ê°€ main.jsë¡œ ì „ë‹¬ë˜ì–´ ì»¤ìŠ¤í…€ ë¦¬í¬íŠ¸ê°€ ìƒì„±ë  ì˜ˆì •ì…ë‹ˆë‹¤.');
    } catch (error) {
      console.error('ê²°ê³¼ ì €ì¥ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
    }

    if (page) {
      try {
        // ë©”ëª¨ë¦¬ ì •ë¦¬ (í˜ì´ì§€ê°€ ë‹«í˜€ìˆì§€ ì•Šì€ ê²½ìš°ì—ë§Œ)
        if (!page.isClosed()) {
          await page.evaluate(() => {
            if (window.gc) window.gc();
          });
        }
      } catch (error) {
        console.log('ë©”ëª¨ë¦¬ ì •ë¦¬ ì¤‘ ì˜¤ë¥˜ (ë¬´ì‹œë¨):', error.message);
      }
      
      try {
        await page.close();
      } catch (error) {
        console.log('í˜ì´ì§€ ë‹«ê¸° ì¤‘ ì˜¤ë¥˜ (ë¬´ì‹œë¨):', error.message);
      }
    }
    console.log('ğŸ ì‹œë‚˜ë¦¬ì˜¤ 1 í…ŒìŠ¤íŠ¸ ì™„ë£Œ');
  });

  // 0ë‹¨ê³„: ë¡œê·¸ì¸
  test('ë¡œê·¸ì¸', async () => {
    // ë¡œê·¸ì¸ í˜ì´ì§€ ì ‘ê·¼
    await test.step('ë¡œê·¸ì¸ í˜ì´ì§€ ì ‘ê·¼', async () => {
      await runTestStep('ë¡œê·¸ì¸ í˜ì´ì§€ ì ‘ê·¼', async () => {
        console.log('ğŸŒ ë¡œê·¸ì¸ í˜ì´ì§€ ì ‘ê·¼ ì¤‘...');
        await managers.loginManager.navigateToLoginPage();
        console.log('âœ… ë¡œê·¸ì¸ í˜ì´ì§€ ì ‘ê·¼ ì™„ë£Œ');
      }, page);
    });

    // ë¡œê·¸ì¸ ì •ë³´ ì…ë ¥
    await test.step('ë¡œê·¸ì¸ ì •ë³´ ì…ë ¥', async () => {
      await runTestStep('ë¡œê·¸ì¸ ì •ë³´ ì…ë ¥', async () => {
        console.log('ğŸ“ ë¡œê·¸ì¸ ì •ë³´ ì…ë ¥ ì¤‘...');
        await managers.loginManager.fillLoginCredentials(config);
        console.log('âœ… ë¡œê·¸ì¸ ì •ë³´ ì…ë ¥ ì™„ë£Œ');
      }, page);
    });

    // ë¡œê·¸ì¸ ì‹¤í–‰ ë° ì„±ê³µ í™•ì¸
    await test.step('ë¡œê·¸ì¸ ì‹¤í–‰ ë° ì„±ê³µ í™•ì¸', async () => {
      await runTestStep('ë¡œê·¸ì¸ ì‹¤í–‰ ë° ì„±ê³µ í™•ì¸', async () => {
        console.log('ğŸš€ ë¡œê·¸ì¸ ì‹¤í–‰ ë° ì„±ê³µ í™•ì¸ ì¤‘...');
        await managers.loginManager.submitLoginAndVerify();
        console.log('âœ… ë¡œê·¸ì¸ ì‹¤í–‰ ë° ì„±ê³µ í™•ì¸ ì™„ë£Œ');
      }, page);
    });
  });

  // 1ë‹¨ê³„: ëŒ€ë©”ë‰´ - ì—…ë¬´ì½”ë“œ ë“±ë¡
  test('ëŒ€ë©”ë‰´: ì—…ë¬´ì½”ë“œ ë“±ë¡', async () => {
    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - ì—…ë¬´ì½”ë“œ ë©”ë‰´ ì ‘ê·¼
    await test.step('ì¤‘ë©”ë‰´: ì—…ë¬´ì½”ë“œ ë©”ë‰´ ì ‘ê·¼', async () => {
      await runTestStep('ì—…ë¬´ì½”ë“œ ë©”ë‰´ ì ‘ê·¼', async () => {
        await managers.taskCodeManager.navigateToTaskCodeMenu();
      }, page);
    });

    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - ì—…ë¬´ì½”ë“œ ë“±ë¡ í™”ë©´ ì—´ê¸°
    await test.step('ì¤‘ë©”ë‰´: ì—…ë¬´ì½”ë“œ ë“±ë¡ í™”ë©´ ì—´ê¸°', async () => {
      await runTestStep('ì—…ë¬´ì½”ë“œ ë“±ë¡ í™”ë©´ ì—´ê¸°', async () => {
        await managers.taskCodeManager.openRegistrationForm();
      }, page);
    });

    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - ì—…ë¬´ì½”ë“œ ì •ë³´ ì…ë ¥
    await test.step('ì¤‘ë©”ë‰´: ì—…ë¬´ì½”ë“œ ì •ë³´ ì…ë ¥', async () => {
      await runTestStep('ì—…ë¬´ì½”ë“œ ì •ë³´ ì…ë ¥', async () => {
        await managers.taskCodeManager.fillTaskCodeInfo(config);
      }, page);
    });

    // ì˜ë„ì ìœ¼ë¡œ ì‹¤íŒ¨í•˜ëŠ” í…ŒìŠ¤íŠ¸ ì¶”ê°€
    // ì˜ë„ì  ì‹¤íŒ¨ í…ŒìŠ¤íŠ¸ëŠ” ì£¼ì„ ì²˜ë¦¬
    // await test.step('ì¤‘ë©”ë‰´: ì˜ë„ì  ì‹¤íŒ¨ í…ŒìŠ¤íŠ¸', async () => {
    //   await runTestStep('ì˜ë„ì  ì‹¤íŒ¨ í…ŒìŠ¤íŠ¸', async () => {
    //     throw new Error('ì˜ë„ì ìœ¼ë¡œ ì‹¤íŒ¨í•˜ëŠ” í…ŒìŠ¤íŠ¸ì…ë‹ˆë‹¤.');
    //   });
    // });

    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - ì—…ë¬´ì½”ë“œ ì €ì¥ ë° í™•ì¸
    await test.step('ì¤‘ë©”ë‰´: ì—…ë¬´ì½”ë“œ ì €ì¥ ë° í™•ì¸', async () => {
      await runTestStep('ì—…ë¬´ì½”ë“œ ì €ì¥ ë° í™•ì¸', async () => {
        await managers.taskCodeManager.saveAndVerifyTaskCode(config);
      }, page);
    });
  });

  // 1ë‹¨ê³„: ëŒ€ë©”ë‰´ - íˆ´ì²´ì¸ ë“±ë¡
  test('ëŒ€ë©”ë‰´: íˆ´ì²´ì¸ ë“±ë¡', async () => {
    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - íˆ´ì²´ì¸ ë©”ë‰´ ì ‘ê·¼
    await test.step('ì¤‘ë©”ë‰´: íˆ´ì²´ì¸ ë©”ë‰´ ì ‘ê·¼', async () => {
      await runTestStep('íˆ´ì²´ì¸ ë©”ë‰´ ì ‘ê·¼', async () => {
        await managers.toolchainManager.navigateToToolchainMenu();
      }, page);
    });

    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - íˆ´ì²´ì¸ ë“±ë¡ í™”ë©´ ì—´ê¸°
    await test.step('ì¤‘ë©”ë‰´: íˆ´ì²´ì¸ ë“±ë¡ í™”ë©´ ì—´ê¸°', async () => {
      await runTestStep('íˆ´ì²´ì¸ ë“±ë¡ í™”ë©´ ì—´ê¸°', async () => {
        await managers.toolchainManager.openRegistrationForm();
      }, page);
    });

    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - íˆ´ì²´ì¸ ê¸°ë³¸ ì •ë³´ ì…ë ¥
    await test.step('ì¤‘ë©”ë‰´: íˆ´ì²´ì¸ ê¸°ë³¸ ì •ë³´ ì…ë ¥', async () => {
      await runTestStep('íˆ´ì²´ì¸ ê¸°ë³¸ ì •ë³´ ì…ë ¥', async () => {
        await managers.toolchainManager.fillBasicInfo(config);
      }, page);
    });

    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - íˆ´ì²´ì¸ ì €ì¥ ë° í™•ì¸
    await test.step('ì¤‘ë©”ë‰´: íˆ´ì²´ì¸ ì €ì¥ ë° í™•ì¸', async () => {
      await runTestStep('íˆ´ì²´ì¸ ì €ì¥ ë° í™•ì¸', async () => {
        await managers.toolchainManager.saveAndVerifyToolchain(config);
      }, page);
    });
  });

  // 1ë‹¨ê³„: ëŒ€ë©”ë‰´ - ì €ì¥ì†Œ ë“±ë¡
  test('ëŒ€ë©”ë‰´: ì €ì¥ì†Œ ë“±ë¡', async () => {
    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - ì €ì¥ì†Œ ë©”ë‰´ ì ‘ê·¼
    await test.step('ì¤‘ë©”ë‰´: ì €ì¥ì†Œ ë©”ë‰´ ì ‘ê·¼', async () => {
      await runTestStep('ì €ì¥ì†Œ ë©”ë‰´ ì ‘ê·¼', async () => {
        await managers.repositoryManager.navigateToRepositoryMenu();
      }, page);
    });

    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - ì €ì¥ì†Œ ë“±ë¡ í™”ë©´ ì—´ê¸°
    await test.step('ì¤‘ë©”ë‰´: ì €ì¥ì†Œ ë“±ë¡ í™”ë©´ ì—´ê¸°', async () => {
      await runTestStep('ì €ì¥ì†Œ ë“±ë¡ í™”ë©´ ì—´ê¸°', async () => {
        await managers.repositoryManager.openRegistrationForm();
      }, page);
    });

    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - ì €ì¥ì†Œ ì •ë³´ ì…ë ¥
    await test.step('ì¤‘ë©”ë‰´: ì €ì¥ì†Œ ì •ë³´ ì…ë ¥', async () => {
      await runTestStep('ì €ì¥ì†Œ ì •ë³´ ì…ë ¥', async () => {
        await managers.repositoryManager.fillRepositoryInfo(config);
      }, page);
    });

    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - ì €ì¥ì†Œ ì €ì¥ ë° í™•ì¸
    await test.step('ì¤‘ë©”ë‰´: ì €ì¥ì†Œ ì €ì¥ ë° í™•ì¸', async () => {
      await runTestStep('ì €ì¥ì†Œ ì €ì¥ ë° í™•ì¸', async () => {
        await managers.repositoryManager.saveAndVerifyRepository(config);
      }, page);
    });

    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - ë°°ì¹˜ íŒŒì¼ ì‹¤í–‰
    await test.step('ì¤‘ë©”ë‰´: ë°°ì¹˜ íŒŒì¼ ì‹¤í–‰', async () => {
      await runTestStep('ë°°ì¹˜ íŒŒì¼ ì‹¤í–‰', async () => {
        console.log('ğŸ“ ë°°ì¹˜ íŒŒì¼ ì‹¤í–‰ ì¤‘...');
        await executeBatchFile(config.project.code);
        console.log('âœ… ë°°ì¹˜ íŒŒì¼ ì‹¤í–‰ ì™„ë£Œ');
      }, page);
    });

         // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - GitLab íŒŒì¼ ìˆ˜ì •
     await test.step('ì¤‘ë©”ë‰´: GitLab íŒŒì¼ ìˆ˜ì •', async () => {
       // GitLab íŒŒì¼ ìˆ˜ì •ì€ ìƒˆ íƒ­ì—ì„œ ì‹¤í–‰ë˜ë¯€ë¡œ ê¸°ì¡´ íƒ­ ìŠ¤í¬ë¦°ìƒ· ëŒ€ì‹  ìƒˆ íƒ­ ìŠ¤í¬ë¦°ìƒ·ë§Œ ì‚¬ìš©
       const stepName = 'GitLab íŒŒì¼ ìˆ˜ì •';
       let testCase = testResults.testCases.find(tc => tc.name === stepName);
       if (!testCase) {
         testCase = {
           name: stepName,
           status: 'pending',
           startTime: null,
           endTime: null,
           error: null,
           duration: 0,
           logs: [],
           screenshots: []
         };
         testResults.testCases.push(testCase);
       }
       
       // í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‹œì‘
       testCase.status = 'pending';
       testCase.startTime = new Date().toISOString();
       testCase.error = null;
       testCase.logs = [];
       testCase.screenshots = []; // ìŠ¤í¬ë¦°ìƒ· ì´ˆê¸°í™”
       
       const startTime = new Date();
       
       // ë¡œê·¸ ìº¡ì²˜ í•¨ìˆ˜
       const captureLog = (type, message) => {
         const timestamp = new Date().toISOString();
         testCase.logs.push({ timestamp, type, message });
         
         const logPrefix = type === 'error' ? 'âŒ' : type === 'success' ? 'âœ…' : type === 'warning' ? 'âš ï¸' : 'â„¹ï¸';
         const logMessage = `${logPrefix} ${stepName}: ${message}`;
         
         // process.stdout.writeë¡œ ì§ì ‘ ì¶œë ¥
         if (process.stdout && process.stdout.write) {
           process.stdout.write(logMessage + '\n');
           process.stdout.write('');
         }
         
         // process.stderrë¡œë„ ì¶œë ¥
         if (process.stderr && process.stderr.write) {
           process.stderr.write(logMessage + '\n');
           process.stderr.write('');
         }
         
         // fs.writeSyncë¡œë„ ì¶œë ¥
         try {
           fs.writeSync(process.stdout.fd, logMessage + '\n');
         } catch (error) {
           // ë¬´ì‹œ
         }
         
         console.log(logMessage);
       };
       
       captureLog('info', `ğŸ“ ${stepName} ì‹œì‘...`);
       
       try {
         console.log('ğŸ”§ GitLab íŒŒì¼ ìˆ˜ì • ì‹¤í–‰ ì¤‘...');
         const gitlabScreenshotPath = await managers.gitlabManager.modifyFileInGitLabInNewTab(
           browser,
           config,
           'src/main/resources/templates/memberList.html',
           9,
           '<h1> ìë™í™” í…ŒìŠ¤íŠ¸ </h1>',
           'Auto-test: Update memberList.html with automation test'
         );
         console.log('âœ… GitLab íŒŒì¼ ìˆ˜ì • ì™„ë£Œ');
         
         // GitLab ì»¤ë°‹ ì™„ë£Œ ìŠ¤í¬ë¦°ìƒ·ì„ í˜„ì¬ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ì— ì¶”ê°€ (ê¸°ì¡´ íƒ­ ìŠ¤í¬ë¦°ìƒ· ëŒ€ì‹ )
         if (gitlabScreenshotPath) {
           testCase.screenshots.push({
             path: gitlabScreenshotPath,
             description: 'GitLab ì»¤ë°‹ ì™„ë£Œ ìŠ¤í¬ë¦°ìƒ·',
             timestamp: new Date().toISOString()
           });
           console.log(`ğŸ“¸ GitLab ìŠ¤í¬ë¦°ìƒ· ì¶”ê°€ë¨: ${gitlabScreenshotPath}`);
         }
         
         testCase.status = 'pass';
         captureLog('success', `âœ… ${stepName} ì„±ê³µ`);
         
       } catch (error) {
         testCase.status = 'fail';
         testCase.error = error;
         testResults.status = 'fail';
         testResults.error = error;
         
         captureLog('error', `âŒ ${stepName} ì‹¤íŒ¨: ${error.message}`);
         throw error;
         
       } finally {
         testCase.endTime = new Date().toISOString();
         const endTime = new Date();
         const duration = endTime - startTime;
         testCase.duration = duration;
         captureLog('info', `â±ï¸ ${stepName} ì†Œìš”ì‹œê°„: ${duration}ms`);
       }
     });
  });

  // 1ë‹¨ê³„: ëŒ€ë©”ë‰´ - ì‚¬ìš©ì ë“±ë¡ (ì£¼ì„ì²˜ë¦¬ë¨)
  // test('ëŒ€ë©”ë‰´: ì‚¬ìš©ì ë“±ë¡', async () => {
  //   // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - ì‚¬ìš©ì ë©”ë‰´ ì ‘ê·¼
  //   await test.step('ì¤‘ë©”ë‰´: ì‚¬ìš©ì ë©”ë‰´ ì ‘ê·¼', async () => {
  //     console.log('ğŸ“ ì‚¬ìš©ì ë©”ë‰´ ì ‘ê·¼ ì‹œì‘...');
  //     try {
  //       await managers.utils.clickSubMenuOnly('ì‚¬ìš©ì ì •ë³´ ê´€ë¦¬');
  //       console.log('âœ… ì‚¬ìš©ì ë©”ë‰´ ì ‘ê·¼ ì„±ê³µ');
  //     } catch (error) {
  //       console.log('âŒ ì‚¬ìš©ì ë©”ë‰´ ì ‘ê·¼ ì‹¤íŒ¨');
  //       throw error;
  //     }
  //   });

  //   // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - ì‚¬ìš©ì ë“±ë¡ í™”ë©´ ì—´ê¸°
  //   await test.step('ì¤‘ë©”ë‰´: ì‚¬ìš©ì ë“±ë¡ í™”ë©´ ì—´ê¸°', async () => {
  //     console.log('ğŸ“ ì‚¬ìš©ì ë“±ë¡ í™”ë©´ ì—´ê¸° ì‹œì‘...');
  //     try {
  //       await managers.utils.clickRegister();
  //       console.log('âœ… ì‚¬ìš©ì ë“±ë¡ í™”ë©´ ì—´ê¸° ì„±ê³µ');
  //     } catch (error) {
  //       console.log('âŒ ì‚¬ìš©ì ë“±ë¡ í™”ë©´ ì—´ê¸° ì‹¤íŒ¨');
  //       throw error;
  //     }
  //   });

  //   // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - ì‚¬ìš©ì ê¸°ë³¸ ì •ë³´ ì…ë ¥
  //   await test.step('ì¤‘ë©”ë‰´: ì‚¬ìš©ì ê¸°ë³¸ ì •ë³´ ì…ë ¥', async () => {
  //     console.log('ğŸ“ ì‚¬ìš©ì ê¸°ë³¸ ì •ë³´ ì…ë ¥ ì‹œì‘...');
  //     try {
  //       await managers.utils.fillInput('input[placeholder="ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"]', config.user.id);
  //       await managers.utils.fillInput('input[placeholder="ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"]', config.user.name);
  //       await managers.utils.fillInput('input[placeholder="ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"]', config.user.email);
        
  //       const selectInputs = managers.utils.page.locator('input[placeholder="ì„ íƒ"]');
  //       await selectInputs.nth(1).fill(config.user.level);
  //       console.log('âœ… ì‚¬ìš©ì ê¸°ë³¸ ì •ë³´ ì…ë ¥ ì„±ê³µ');
  //     } catch (error) {
  //       console.log('âŒ ì‚¬ìš©ì ê¸°ë³¸ ì •ë³´ ì…ë ¥ ì‹¤íŒ¨');
  //       throw error;
  //     }
  //   });

  //   // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - í‹°ì¼“ ì „ìš© ì—…ë¬´ ë° ì—­í•  ì„¤ì •
  //   await test.step('ì¤‘ë©”ë‰´: í‹°ì¼“ ì „ìš© ì—…ë¬´ ë° ì—­í•  ì„¤ì •', async () => {
  //     console.log('ğŸ“ í‹°ì¼“ ì „ìš© ì—…ë¬´ ë° ì—­í•  ì„¤ì • ì‹œì‘...');
  //     try {
  //       const taskCodeText = `${config.project.name}(${config.project.code})`;
  //       await managers.utils.fillInput('input[placeholder="ì—…ë¬´ì½”ë“œ ì„ íƒ"]', taskCodeText);
  //       await managers.utils.fillInput('input[placeholder="í‹°ì¼“ ì—­í•  ì„ íƒ"]', config.user.role);
  //       await managers.utils.page.click('#root > div > main > div > div.box-content-wrap > form > div:nth-child(3) > form > div > div.dashboard-title > div.elem-group > button > span > span');
  //       console.log('âœ… í‹°ì¼“ ì „ìš© ì—…ë¬´ ë° ì—­í•  ì„¤ì • ì„±ê³µ');
  //     } catch (error) {
  //       console.log('âŒ í‹°ì¼“ ì „ìš© ì—…ë¬´ ë° ì—­í•  ì„¤ì • ì‹¤íŒ¨');
  //       throw error;
  //     }
  //   });

  //   // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - ì‚¬ìš©ì ì—…ë¬´ ë° ì—­í•  ì„¤ì •
  //   await test.step('ì¤‘ë©”ë‰´: ì‚¬ìš©ì ì—…ë¬´ ë° ì—­í•  ì„¤ì •', async () => {
  //     console.log('ğŸ“ ì‚¬ìš©ì ì—…ë¬´ ë° ì—­í•  ì„¤ì • ì‹œì‘...');
  //     try {
  //       const taskCodeText = `${config.project.name}(${config.project.code})`;
  //       const selectCodeInputs = managers.utils.page.locator('input[placeholder="ì—…ë¬´ì½”ë“œ ì„ íƒ"]');
  //       await selectCodeInputs.nth(1).fill(taskCodeText);
  //       await managers.utils.fillInput('input[placeholder="ì‚¬ìš©ì ì—­í•  ì„ íƒ"]', config.user.systemRole);
  //       await managers.utils.page.click('#root > div > main > div > div.box-content-wrap > form > div:nth-child(4) > form > div > div.dashboard-title > div.elem-group > button > span > span');
  //       console.log('âœ… ì‚¬ìš©ì ì—…ë¬´ ë° ì—­í•  ì„¤ì • ì„±ê³µ');
  //     } catch (error) {
  //       console.log('âŒ ì‚¬ìš©ì ì—…ë¬´ ë° ì—­í•  ì„¤ì • ì‹¤íŒ¨');
  //       throw error;
  //     }
  //   });

  //   // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - ì‚¬ìš©ì êµ¬ë¶„ ì„¤ì •
  //   await test.step('ì¤‘ë©”ë‰´: ì‚¬ìš©ì êµ¬ë¶„ ì„¤ì •', async () => {
  //     console.log('ğŸ“ ì‚¬ìš©ì êµ¬ë¶„ ì„¤ì • ì‹œì‘...');
  //     try {
  //       const userTypeButton = '#root > div > main > div > div.box-content-wrap > form > div:nth-child(7) > div > div.table-wrap.mgt-base > table > tbody > tr:nth-child(1) > td:nth-child(2) > div > div > div > button';
  //       await managers.utils.page.click(userTypeButton);
  //       await managers.utils.page.click('text=ì§ì›');
  //       console.log('âœ… ì‚¬ìš©ì êµ¬ë¶„ ì„¤ì • ì„±ê³µ');
  //     } catch (error) {
  //       console.log('âŒ ì‚¬ìš©ì êµ¬ë¶„ ì„¤ì • ì‹¤íŒ¨');
  //       throw error;
  //     }
  //   });

  //   // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - ì‚¬ìš©ì ì €ì¥ ë° í™•ì¸
  //   await test.step('ì¤‘ë©”ë‰´: ì‚¬ìš©ì ì €ì¥ ë° í™•ì¸', async () => {
  //     console.log('ğŸ“ ì‚¬ìš©ì ì €ì¥ ë° í™•ì¸ ì‹œì‘...');
  //     try {
  //       const saveButton = managers.utils.page.locator('button:has-text("ì €ì¥")');
        
  //       // ì €ì¥ ë²„íŠ¼ì´ ì•ˆì •í™”ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¼
  //       let isEnabled = false;
  //       let attempts = 0;
  //       const maxAttempts = 10;
        
  //       while (attempts < maxAttempts) {
  //         isEnabled = await saveButton.isEnabled();
  //         await managers.utils.page.waitForTimeout(300);
  //         const newIsEnabled = await saveButton.isEnabled();
          
  //         if (isEnabled === newIsEnabled) {
  //           break;
  //         }
          
  //         isEnabled = newIsEnabled;
  //         attempts++;
  //       }
        
  //       if (isEnabled) {
  //         await managers.utils.saveAndConfirm();
  //         await managers.utils.wait(5000);
  //         console.log('ì‚¬ìš©ìê°€ ì •ìƒì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.');
  //       } else {
  //         await managers.utils.cancelAndConfirm();
  //         console.log('ì´ë¯¸ ë“±ë¡ëœ ì‚¬ìš©ìì…ë‹ˆë‹¤.');
  //       }
  //       console.log('âœ… ì‚¬ìš©ì ì €ì¥ ë° í™•ì¸ ì„±ê³µ');
  //     } catch (error) {
  //       console.log('âŒ ì‚¬ìš©ì ì €ì¥ ë° í™•ì¸ ì‹¤íŒ¨');
  //       throw error;
  //     }
  //   });
  // });

  // 1ë‹¨ê³„: ëŒ€ë©”ë‰´ - ì‚¬ìš©ìì—ê²Œ ì—…ë¬´ì½”ë“œ í• ë‹¹
  test('ëŒ€ë©”ë‰´: ì‚¬ìš©ìì—ê²Œ ì—…ë¬´ì½”ë“œ í• ë‹¹', async () => {
    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - ì‚¬ìš©ì ì—…ë¬´ì½”ë“œ ë©”ë‰´ ì ‘ê·¼
    await test.step('ì¤‘ë©”ë‰´: ì‚¬ìš©ì ì—…ë¬´ì½”ë“œ ë©”ë‰´ ì ‘ê·¼', async () => {
      await runTestStep('ì‚¬ìš©ì ì—…ë¬´ì½”ë“œ ë©”ë‰´ ì ‘ê·¼', async () => {
        await managers.userTaskCodeManager.navigateToUserTaskCodeMenu();
      }, page);
    });

    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - ì‚¬ìš©ì ì—…ë¬´ì½”ë“œ ë“±ë¡ í™”ë©´ ì—´ê¸°
    await test.step('ì¤‘ë©”ë‰´: ì‚¬ìš©ì ì—…ë¬´ì½”ë“œ ë“±ë¡ í™”ë©´ ì—´ê¸°', async () => {
      await runTestStep('ì‚¬ìš©ì ì—…ë¬´ì½”ë“œ ë“±ë¡ í™”ë©´ ì—´ê¸°', async () => {
        await managers.userTaskCodeManager.openRegistrationForm();
      }, page);
    });

    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - ì‚¬ìš©ì ì—…ë¬´ì½”ë“œ ì •ë³´ ì…ë ¥
    await test.step('ì¤‘ë©”ë‰´: ì‚¬ìš©ì ì—…ë¬´ì½”ë“œ ì •ë³´ ì…ë ¥', async () => {
      await runTestStep('ì‚¬ìš©ì ì—…ë¬´ì½”ë“œ ì •ë³´ ì…ë ¥', async () => {
        await managers.userTaskCodeManager.fillUserTaskCodeInfo(config);
      }, page);
    });

    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - ì‚¬ìš©ì ì—…ë¬´ì½”ë“œ ì €ì¥ ë° í™•ì¸
    await test.step('ì¤‘ë©”ë‰´: ì‚¬ìš©ì ì—…ë¬´ì½”ë“œ ì €ì¥ ë° í™•ì¸', async () => {
      await runTestStep('ì‚¬ìš©ì ì—…ë¬´ì½”ë“œ ì €ì¥ ë° í™•ì¸', async () => {
        await managers.userTaskCodeManager.saveAndVerifyUserTaskCode(config);
      }, page);
    });
  });

  // 1ë‹¨ê³„: ëŒ€ë©”ë‰´ - SonarQube ë“±ë¡
  test('ëŒ€ë©”ë‰´: SonarQube ë“±ë¡', async () => {
    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - SonarQube ë©”ë‰´ ì ‘ê·¼
    await test.step('ì¤‘ë©”ë‰´: SonarQube ë©”ë‰´ ì ‘ê·¼', async () => {
      await runTestStep('SonarQube ë©”ë‰´ ì ‘ê·¼', async () => {
        await managers.sonarQubeManager.navigateToSonarQubeMenu();
      }, page);
    });

    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - SonarQube ë“±ë¡ í™”ë©´ ì—´ê¸°
    await test.step('ì¤‘ë©”ë‰´: SonarQube ë“±ë¡ í™”ë©´ ì—´ê¸°', async () => {
      await runTestStep('SonarQube ë“±ë¡ í™”ë©´ ì—´ê¸°', async () => {
        await managers.sonarQubeManager.openRegistrationForm();
      }, page);
    });

    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - SonarQube ì •ë³´ ì…ë ¥
    await test.step('ì¤‘ë©”ë‰´: SonarQube ì •ë³´ ì…ë ¥', async () => {
      await runTestStep('SonarQube ì •ë³´ ì…ë ¥', async () => {
        await managers.sonarQubeManager.fillSonarQubeInfo(config);
      }, page);
    });

    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - SonarQube ì €ì¥ ë° í™•ì¸
    await test.step('ì¤‘ë©”ë‰´: SonarQube ì €ì¥ ë° í™•ì¸', async () => {
      await runTestStep('SonarQube ì €ì¥ ë° í™•ì¸', async () => {
        await managers.sonarQubeManager.saveAndVerifySonarQube(config);
      }, page);
    });
  });

  // 1ë‹¨ê³„: ëŒ€ë©”ë‰´ - JUnit ë“±ë¡
  test('ëŒ€ë©”ë‰´: JUnit ë“±ë¡', async () => {
    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - JUnit ë©”ë‰´ ì ‘ê·¼
    await test.step('ì¤‘ë©”ë‰´: JUnit ë©”ë‰´ ì ‘ê·¼', async () => {
      await runTestStep('JUnit ë©”ë‰´ ì ‘ê·¼', async () => {
        await managers.jUnitManager.navigateToJUnitMenu();
      }, page);
    });

    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - JUnit ë“±ë¡ í™”ë©´ ì—´ê¸°
    await test.step('ì¤‘ë©”ë‰´: JUnit ë“±ë¡ í™”ë©´ ì—´ê¸°', async () => {
      await runTestStep('JUnit ë“±ë¡ í™”ë©´ ì—´ê¸°', async () => {
        await managers.jUnitManager.openRegistrationForm();
      }, page);
    });

    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - JUnit ì •ë³´ ì…ë ¥
    await test.step('ì¤‘ë©”ë‰´: JUnit ì •ë³´ ì…ë ¥', async () => {
      await runTestStep('JUnit ì •ë³´ ì…ë ¥', async () => {
        await managers.jUnitManager.fillJUnitInfo(config);
      }, page);
    });

    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - JUnit ì €ì¥ ë° í™•ì¸
    await test.step('ì¤‘ë©”ë‰´: JUnit ì €ì¥ ë° í™•ì¸', async () => {
      await runTestStep('JUnit ì €ì¥ ë° í™•ì¸', async () => {
        await managers.jUnitManager.saveAndVerifyJUnit(config);
      }, page);
    });
  });

  // 1ë‹¨ê³„: ëŒ€ë©”ë‰´ - íŒŒì´í”„ë¼ì¸ ë“±ë¡
  test('ëŒ€ë©”ë‰´: íŒŒì´í”„ë¼ì¸ ë“±ë¡', async () => {
    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - STG íŒŒì´í”„ë¼ì¸ ë“±ë¡
    await test.step('ì¤‘ë©”ë‰´: STG íŒŒì´í”„ë¼ì¸ ë“±ë¡', async () => {
      await runTestStep('STG íŒŒì´í”„ë¼ì¸ ë“±ë¡', async () => {
        // STG íŒŒì´í”„ë¼ì¸ í…œí”Œë¦¿ì—ì„œ ë™ì ìœ¼ë¡œ ë‚´ìš© ìƒì„±
        const stgTemplatePath = path.join(__dirname, '../../tests/pipeline-stg.txt');
        const stgPipelineContent = await generatePipelineContent(stgTemplatePath, config.project.code);
        
        // ì„ì‹œ íŒŒì¼ì— ìƒì„±ëœ ë‚´ìš© ì €ì¥
        const tempStgPath = path.join(__dirname, '../../tests/temp-pipeline-stg.txt');
        fs.writeFileSync(tempStgPath, stgPipelineContent);
        
        // íŒŒì´í”„ë¼ì¸ ë“±ë¡
        await managers.pipelineManager.createPipeline(`${config.project.code}-STG`, 'STG', tempStgPath, config);
        
        // ì„ì‹œ íŒŒì¼ ì‚­ì œ
        fs.unlinkSync(tempStgPath);
      }, page);
    });

    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - PRD íŒŒì´í”„ë¼ì¸ ë“±ë¡
    await test.step('ì¤‘ë©”ë‰´: PRD íŒŒì´í”„ë¼ì¸ ë“±ë¡', async () => {
      await runTestStep('PRD íŒŒì´í”„ë¼ì¸ ë“±ë¡', async () => {
        // PRD íŒŒì´í”„ë¼ì¸ í…œí”Œë¦¿ì—ì„œ ë™ì ìœ¼ë¡œ ë‚´ìš© ìƒì„±
        const prdTemplatePath = path.join(__dirname, '../../tests/pipeline-prd.txt');
        const prdPipelineContent = await generatePipelineContent(prdTemplatePath, config.project.code);
        
        // ì„ì‹œ íŒŒì¼ì— ìƒì„±ëœ ë‚´ìš© ì €ì¥
        const tempPrdPath = path.join(__dirname, '../../tests/temp-pipeline-prd.txt');
        fs.writeFileSync(tempPrdPath, prdPipelineContent);
        
        // íŒŒì´í”„ë¼ì¸ ë“±ë¡
        await managers.pipelineManager.createPipeline(`${config.project.code}-PRD`, 'PRD', tempPrdPath, config);
        
        // ì„ì‹œ íŒŒì¼ ì‚­ì œ
        fs.unlinkSync(tempPrdPath);
      }, page);
    });
  });

  // 1ë‹¨ê³„: ëŒ€ë©”ë‰´ - ì›Œí¬í”Œë¡œìš° ì»´í¬ë„ŒíŠ¸ ë“±ë¡
  test('ëŒ€ë©”ë‰´: ì›Œí¬í”Œë¡œìš° ì»´í¬ë„ŒíŠ¸ ë“±ë¡', async () => {
    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - ì›Œí¬í”Œë¡œìš° ì»´í¬ë„ŒíŠ¸ ë©”ë‰´ ì ‘ê·¼
    await test.step('ì¤‘ë©”ë‰´: ì›Œí¬í”Œë¡œìš° ì»´í¬ë„ŒíŠ¸ ë©”ë‰´ ì ‘ê·¼', async () => {
      await runTestStep('ì›Œí¬í”Œë¡œìš° ì»´í¬ë„ŒíŠ¸ ë©”ë‰´ ì ‘ê·¼', async () => {
        await managers.workflowComponentManager.navigateToWorkflowComponentMenu();
      }, page);
    });

    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - ì›Œí¬í”Œë¡œìš° ì»´í¬ë„ŒíŠ¸ ë“±ë¡ í™”ë©´ ì—´ê¸°
    await test.step('ì¤‘ë©”ë‰´: ì›Œí¬í”Œë¡œìš° ì»´í¬ë„ŒíŠ¸ ë“±ë¡ í™”ë©´ ì—´ê¸°', async () => {
      await runTestStep('ì›Œí¬í”Œë¡œìš° ì»´í¬ë„ŒíŠ¸ ë“±ë¡ í™”ë©´ ì—´ê¸°', async () => {
        await managers.workflowComponentManager.openRegistrationForm();
      }, page);
    });

    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - ì›Œí¬í”Œë¡œìš° ì»´í¬ë„ŒíŠ¸ ì •ë³´ ì…ë ¥
    await test.step('ì¤‘ë©”ë‰´: ì›Œí¬í”Œë¡œìš° ì»´í¬ë„ŒíŠ¸ ì •ë³´ ì…ë ¥', async () => {
      await runTestStep('ì›Œí¬í”Œë¡œìš° ì»´í¬ë„ŒíŠ¸ ì •ë³´ ì…ë ¥', async () => {
        await managers.workflowComponentManager.fillWorkflowComponentInfo(config);
      }, page);
    });

    // 2ë‹¨ê³„: ì¤‘ë©”ë‰´ - ì›Œí¬í”Œë¡œìš° ì»´í¬ë„ŒíŠ¸ ì €ì¥ ë° í™•ì¸
    await test.step('ì¤‘ë©”ë‰´: ì›Œí¬í”Œë¡œìš° ì»´í¬ë„ŒíŠ¸ ì €ì¥ ë° í™•ì¸', async () => {
      await runTestStep('ì›Œí¬í”Œë¡œìš° ì»´í¬ë„ŒíŠ¸ ì €ì¥ ë° í™•ì¸', async () => {
        await managers.workflowComponentManager.saveAndVerifyWorkflowComponent(config);
      }, page);
    });
  });

  // 3ë‹¨ê³„: ìƒˆ íƒ­ì—ì„œ ë¡œê·¸ì¸ ë° í™•ì¸ (ì£¼ì„ì²˜ë¦¬)
  // test('ìƒˆ íƒ­ì—ì„œ ë¡œê·¸ì¸ ë° í™•ì¸', async () => {
  //   await test.step('ìƒˆ íƒ­ì—ì„œ ë¡œê·¸ì¸ ë° í™•ì¸', async () => {
  //     await runTestStep('ìƒˆ íƒ­ì—ì„œ ë¡œê·¸ì¸', async () => {
  //       let newPage = null;
  //       try {
  //         // ìƒˆ íƒ­ì—ì„œ ë¡œê·¸ì¸ ìˆ˜í–‰
  //         console.log('ğŸ” ìƒˆ íƒ­ì—ì„œ ë¡œê·¸ì¸ ì‹œë„ ì¤‘...');
  //         newPage = await managers.ticketApproval.loginInNewTab(config, browser);
  //         
  //         // ë¡œê·¸ì¸ ì„±ê³µ í™•ì¸
  //         if (!newPage) {
  //           throw new Error('ìƒˆ íƒ­ ìƒì„± ì‹¤íŒ¨');
  //         }
  //         if (newPage.isClosed()) {
  //           throw new Error('ìƒˆ íƒ­ì´ ë‹«í˜€ìˆìŒ');
  //         }
  //         
  //         // URL í™•ì¸
  //         const currentURL = newPage.url();
  //         if (currentURL !== 'http://trombone.qa.okestro.cloud/') {
  //           throw new Error(`ì˜ëª»ëœ URL: ${currentURL}`);
  //         }
  //         
  //         console.log('âœ… ìƒˆ íƒ­ ë¡œê·¸ì¸ ì„±ê³µ');
  //         
  //         // íƒ­ ê°„ ì „í™˜ í…ŒìŠ¤íŠ¸
  //         console.log('ğŸ”„ íƒ­ ê°„ ì „í™˜ í…ŒìŠ¤íŠ¸ ì¤‘...');
  //         await managers.ticketApproval.switchBetweenTabs(page, newPage);
  //         console.log('âœ… íƒ­ ê°„ ì „í™˜ í…ŒìŠ¤íŠ¸ ì„±ê³µ');
  //         
  //       } catch (error) {
  //         console.log('âŒ ìƒˆ íƒ­ ë¡œê·¸ì¸ ì‹¤íŒ¨:', error.message);
  //         throw error;
  //       } finally {
  //         // ìƒˆ íƒ­ ì •ë¦¬
  //         if (newPage && !newPage.isClosed()) {
  //           console.log('ğŸ§¹ ìƒˆ íƒ­ ì •ë¦¬ ì¤‘...');
  //           await managers.ticketApproval.closeNewTab(newPage);
  //           console.log('âœ… ìƒˆ íƒ­ ì •ë¦¬ ì™„ë£Œ');
  //         }
  //       }
  //     }, page);
  //   });
  // });

  // 4ë‹¨ê³„: í‹°ì¼“ ìƒì„± (ì„¸ë¶€ ë‹¨ê³„)
  test('ëŒ€ë©”ë‰´: í‹°ì¼“ ìƒì„±', async () => {
    await test.step('ì¤‘ë©”ë‰´: í‹°ì¼“ ìƒì„±', async () => {
      // í‹°ì¼“ ê´€ë¦¬ ë©”ë‰´ ì ‘ê·¼
      await runTestStep('í‹°ì¼“ ê´€ë¦¬ ë©”ë‰´ ì ‘ê·¼', async () => {
        await managers.ticketCreateManager.executeTicketMenuNavigation();
      }, page);

      // í‹°ì¼“ ë“±ë¡ í™”ë©´ ì—´ê¸°
      await runTestStep('í‹°ì¼“ ë“±ë¡ í™”ë©´ ì—´ê¸°', async () => {
        await managers.ticketCreateManager.executeTicketRegistrationFormOpen();
      }, page);

      // í‹°ì¼“ ê¸°ë³¸ ì •ë³´ ì…ë ¥
      await runTestStep('í‹°ì¼“ ê¸°ë³¸ ì •ë³´ ì…ë ¥', async () => {
        await managers.ticketCreateManager.executeTicketBasicInfoFill(config);
      }, page);

      // ì›Œí¬í”Œë¡œìš° ë° ìŠ¹ì¸ ì„¤ì •
      await runTestStep('ì›Œí¬í”Œë¡œìš° ë° ìŠ¹ì¸ ì„¤ì •', async () => {
        await managers.ticketCreateManager.executeWorkflowApprovalConfig();
      }, page);

      // ê°œë°œì ë° ë°°í¬ì¼ ì„¤ì •
      await runTestStep('ê°œë°œì ë° ë°°í¬ì¼ ì„¤ì •', async () => {
        await managers.ticketCreateManager.executeDeveloperDeploymentConfig(config);
      }, page);

      // ë¦´ë¦¬ì¦ˆ ë…¸íŠ¸ ì‘ì„±
      await runTestStep('ë¦´ë¦¬ì¦ˆ ë…¸íŠ¸ ì‘ì„±', async () => {
        await managers.ticketCreateManager.executeReleaseNotesFill(config);
      }, page);

      // ì €ì¥ì†Œ ë° ë¸Œëœì¹˜ ì„ íƒ
      await runTestStep('ì €ì¥ì†Œ ë° ë¸Œëœì¹˜ ì„ íƒ', async () => {
        await managers.ticketCreateManager.executeRepositoryBranchSelection(config, managers.gitlabManager);
      }, page);

      // í‹°ì¼“ ì €ì¥
      await runTestStep('í‹°ì¼“ ì €ì¥', async () => {
        await managers.ticketCreateManager.executeTicketSave();
      }, page);
    });
  });

  // 5ë‹¨ê³„: ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤ (ì„¸ë¶€ ë‹¨ê³„)
  test('ëŒ€ë©”ë‰´: ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤', async () => {
    await test.step('ì¤‘ë©”ë‰´: ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤', async () => {
      // ì²« ë²ˆì§¸ ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤
      await runTestStep('ì²« ë²ˆì§¸ ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤', async () => {
        await managers.approvalManager.executeFirstApprovalProcess(browser, config);
      }, page);

      // ë‘ ë²ˆì§¸ ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤
      await runTestStep('ë‘ ë²ˆì§¸ ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤', async () => {
        await managers.approvalManager.executeSecondApprovalProcess(browser, config);
      }, page);

      // ì•Œë¦¼ í™•ì¸
      await runTestStep('ì•Œë¦¼ í™•ì¸', async () => {
        await managers.approvalManager.executeNotificationCheck(config);
      }, page);
    });
  });

  // 5.5ë‹¨ê³„: í‹°ì¼“ ì ‘ê·¼ (ì„¸ë¶€ ë‹¨ê³„)
  test('ëŒ€ë©”ë‰´: í‹°ì¼“ ì ‘ê·¼', async () => {
    await test.step('ì¤‘ë©”ë‰´: í‹°ì¼“ ì ‘ê·¼', async () => {
      // í‹°ì¼“ ì ‘ê·¼
      await runTestStep('í‹°ì¼“ ì ‘ê·¼', async () => {
        await managers.ticketApproachManager.executeTicketApproach(config);
      }, page);
    });
  });

  // 6ë‹¨ê³„: í‹°ì¼“ ì§„í–‰(ì½”ë“œë¦¬ë·° ë‹¨ê³„) (ì„¸ë¶€ ë‹¨ê³„)
  test('ëŒ€ë©”ë‰´: í‹°ì¼“ ì§„í–‰(ì½”ë“œë¦¬ë·° ë‹¨ê³„)', async () => {
    await test.step('ì¤‘ë©”ë‰´: í‹°ì¼“ ì§„í–‰(ì½”ë“œë¦¬ë·° ë‹¨ê³„)', async () => {
      // 1~2ë‹¨ê³„: ì½”ë“œë¦¬ë·° ì ‘ê·¼ ì™„ë£Œ
      await runTestStep('ì½”ë“œë¦¬ë·° ë‹¨ê³„: ì½”ë“œë¦¬ë·° ì ‘ê·¼', async () => {
        await managers.ticketCodeReviewManager.executeCodeReviewAccess(config);
      }, page);

      // 3~7ë‹¨ê³„: ê²€í†  ì˜ê²¬ ì…ë ¥ ì™„ë£Œ
      await runTestStep('ì½”ë“œë¦¬ë·° ë‹¨ê³„: ê²€í†  ì˜ê²¬ ì…ë ¥', async () => {
        await managers.ticketCodeReviewManager.executeReviewCommentComplete();
      }, page);

      // 8ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ê´€ë¦¬ ì§„ì…
      await runTestStep('ì½”ë“œë¦¬ë·° ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ê´€ë¦¬ ì§„ì…', async () => {
        await managers.ticketCodeReviewManager.executeTestCaseManagementEntry();
      }, page);

      // 9ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ë“±ë¡ í™”ë©´ ì§„ì…
      await runTestStep('ì½”ë“œë¦¬ë·° ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ë“±ë¡ í™”ë©´ ì§„ì…', async () => {
        await managers.ticketCodeReviewManager.executeTestCaseRegistrationEntry();
      }, page);

      // 10~12ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì •ë³´ ì…ë ¥
      await runTestStep('ì½”ë“œë¦¬ë·° ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì •ë³´ ì…ë ¥', async () => {
        await managers.ticketCodeReviewManager.executeTestCaseInfoInput();
      }, page);

      // 13~14ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì¶”ê°€ ì™„ë£Œ
      await runTestStep('ì½”ë“œë¦¬ë·° ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì¶”ê°€', async () => {
        await managers.ticketCodeReviewManager.executeTestCaseAdditionComplete();
      }, page);

      // 15~16ë‹¨ê³„: ì½”ë“œ ê²€í†  ì™„ë£Œ
      await runTestStep('ì½”ë“œë¦¬ë·° ë‹¨ê³„: ì½”ë“œ ê²€í† ', async () => {
        await managers.ticketCodeReviewManager.executeCodeReviewComplete();
      }, page);

      // 17ë‹¨ê³„: ì½”ë“œë¦¬ë·° ë‹¨ê³„ ì™„ë£Œ
      await runTestStep('ì½”ë“œë¦¬ë·° ë‹¨ê³„: ì½”ë“œë¦¬ë·° ë‹¨ê³„ ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„ì…', async () => {
        await managers.ticketCodeReviewManager.executeCodeReviewStageComplete();
      }, page);
    });
  });

  // 7ë‹¨ê³„: í‹°ì¼“ ì§„í–‰(ì½”ë“œë³‘í•© ë‹¨ê³„) (ì„¸ë¶€ ë‹¨ê³„)
  test('ëŒ€ë©”ë‰´: í‹°ì¼“ ì§„í–‰(ì½”ë“œë³‘í•© ë‹¨ê³„)', async () => {
    await test.step('ì¤‘ë©”ë‰´: í‹°ì¼“ ì§„í–‰(ì½”ë“œë³‘í•© ë‹¨ê³„)', async () => {
      // ì½”ë“œë³‘í•© ê°€ëŠ¥ í™•ì¸
      await runTestStep('ì½”ë“œë³‘í•©(STG) ë‹¨ê³„: ì½”ë“œë³‘í•©(STG) ê°€ëŠ¥ í™•ì¸', async () => {
        await managers.ticketCodeMergeSTGManager.executeMergeAvailabilityCheck();
      }, page);

      // ì½”ë“œë³‘í•© ì™„ë£Œ
      await runTestStep('ì½”ë“œë³‘í•©(STG) ë‹¨ê³„: ì½”ë“œë³‘í•©(STG) ì§„í–‰', async () => {
        await managers.ticketCodeMergeSTGManager.executeFullMergeProcess();
        await managers.ticketCodeMergeSTGManager.executeMergeVerification();
      }, page);

      // ì½”ë“œë³‘í•© ë‹¨ê³„ ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„ì…
      await runTestStep('ì½”ë“œë³‘í•©(STG) ë‹¨ê³„: ì½”ë“œë³‘í•©(STG) ë‹¨ê³„ ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„ì…', async () => {
        await managers.ticketCodeMergeSTGManager.executeNextStepProgression();
      }, page);
    });
  });

  // 8ë‹¨ê³„: í‹°ì¼“ ì§„í–‰(ë‹¨ìœ„í…ŒìŠ¤íŠ¸ ë‹¨ê³„) (ì„¸ë¶€ ë‹¨ê³„)
  test('ëŒ€ë©”ë‰´: í‹°ì¼“ ì§„í–‰(ë‹¨ìœ„í…ŒìŠ¤íŠ¸ ë‹¨ê³„)', async () => {
    await test.step('ì¤‘ë©”ë‰´: í‹°ì¼“ ì§„í–‰(ë‹¨ìœ„í…ŒìŠ¤íŠ¸ ë‹¨ê³„)', async () => {
      // ë‹¨ìœ„í…ŒìŠ¤íŠ¸ ì™„ë£Œ
      await runTestStep('ë‹¨ìœ„í…ŒìŠ¤íŠ¸ ë‹¨ê³„: ë‹¨ìœ„í…ŒìŠ¤íŠ¸ ì§„í–‰', async () => {
        await managers.ticketUnitTestManager.executeUnitTestWaiting();
        await managers.ticketUnitTestManager.executeUnitTestInProgress();
        await managers.ticketUnitTestManager.executeUnitTestSuccess();
      }, page);

      // ë‹¨ìœ„í…ŒìŠ¤íŠ¸ ë‹¨ê³„ ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„ì…
      await runTestStep('ë‹¨ìœ„í…ŒìŠ¤íŠ¸ ë‹¨ê³„: ë‹¨ìœ„í…ŒìŠ¤íŠ¸ ë‹¨ê³„ ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„ì…', async () => {
        await managers.ticketUnitTestManager.executeNextStepProgression();
      }, page);
    });
  });

  // ì •ì ë¶„ì„ ë‹¨ê³„: í‹°ì¼“ ì§„í–‰(ì •ì ë¶„ì„ ë‹¨ê³„) (ì„¸ë¶€ ë‹¨ê³„)
  test('ëŒ€ë©”ë‰´: í‹°ì¼“ ì§„í–‰(ì •ì ë¶„ì„ ë‹¨ê³„)', async () => {
    await test.step('ì¤‘ë©”ë‰´: í‹°ì¼“ ì§„í–‰(ì •ì ë¶„ì„ ë‹¨ê³„)', async () => {
      // ì •ì ë¶„ì„ ì™„ë£Œ
      await runTestStep('ì •ì ë¶„ì„ ë‹¨ê³„: ì •ì ë¶„ì„ ì§„í–‰', async () => {
        await managers.ticketStaticAnalysisManager.processTicketStaticAnalysis(config);
      }, page);

      // ì •ì ë¶„ì„ ë‹¨ê³„ ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„ì…
      await runTestStep('ì •ì ë¶„ì„ ë‹¨ê³„: ì •ì ë¶„ì„ ë‹¨ê³„ ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„ì…', async () => {
        // ì •ì ë¶„ì„ í”„ë¡œì„¸ìŠ¤ì—ì„œ ì´ë¯¸ ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰í•˜ë¯€ë¡œ ë³„ë„ ì²˜ë¦¬ ë¶ˆí•„ìš”
        console.log('âœ… ì •ì ë¶„ì„ ë‹¨ê³„ ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„ì…');
      }, page);
    });
  });

  // 9ë‹¨ê³„: í‹°ì¼“ ì§„í–‰(ìˆ˜ë™ë°°í¬ ë‹¨ê³„) (ì„¸ë¶€ ë‹¨ê³„)
  test('ëŒ€ë©”ë‰´: í‹°ì¼“ ì§„í–‰(ìˆ˜ë™ë°°í¬ ë‹¨ê³„)', async () => {
    await test.step('ì¤‘ë©”ë‰´: í‹°ì¼“ ì§„í–‰(ìˆ˜ë™ë°°í¬ ë‹¨ê³„)', async () => {
      // ìˆ˜ë™ë°°í¬ ì™„ë£Œ
      await runTestStep('ìˆ˜ë™ë°°í¬(STG) ë‹¨ê³„: ìˆ˜ë™ë°°í¬(STG)', async () => {
        await managers.ticketManualDeploymentSTGManager.processTicketManualDeployment(config);
      }, page);

      // ìˆ˜ë™ë°°í¬ ë‹¨ê³„ ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„ì…
      await runTestStep('ìˆ˜ë™ë°°í¬(STG) ë‹¨ê³„: ìˆ˜ë™ë°°í¬(STG) ë‹¨ê³„ ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„ì…', async () => {
        // ìˆ˜ë™ë°°í¬ í”„ë¡œì„¸ìŠ¤ì—ì„œ ì´ë¯¸ ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰í•˜ë¯€ë¡œ ë³„ë„ ì²˜ë¦¬ ë¶ˆí•„ìš”
        console.log('âœ… ìˆ˜ë™ë°°í¬ ë‹¨ê³„ ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„ì…');
      }, page);
    });
  });

  // 10ë‹¨ê³„: í‹°ì¼“ ì§„í–‰(í†µí•©í…ŒìŠ¤íŠ¸ ë‹¨ê³„) (ì„¸ë¶€ ë‹¨ê³„)
  test('ëŒ€ë©”ë‰´: í‹°ì¼“ ì§„í–‰(í†µí•©í…ŒìŠ¤íŠ¸ ë‹¨ê³„)', async () => {
    await test.step('ì¤‘ë©”ë‰´: í‹°ì¼“ ì§„í–‰(í†µí•©í…ŒìŠ¤íŠ¸ ë‹¨ê³„)', async () => {
      // í†µí•©í…ŒìŠ¤íŠ¸ íŒŒì¼ ì—…ë¡œë“œ ì™„ë£Œ
      await runTestStep('í†µí•©í…ŒìŠ¤íŠ¸ ë‹¨ê³„: í†µí•©í…ŒìŠ¤íŠ¸ íŒŒì¼ ì—…ë¡œë“œ', async () => {
        await managers.ticketIntegrationTestManager.processTicketIntegrationTest(config);
      }, page);

      // í†µí•©í…ŒìŠ¤íŠ¸ ë‹¨ê³„ ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„ì…
      await runTestStep('í†µí•©í…ŒìŠ¤íŠ¸ ë‹¨ê³„: í†µí•©í…ŒìŠ¤íŠ¸ ë‹¨ê³„ ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„ì…', async () => {
        // í†µí•©í…ŒìŠ¤íŠ¸ í”„ë¡œì„¸ìŠ¤ì—ì„œ ì´ë¯¸ ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰í•˜ë¯€ë¡œ ë³„ë„ ì²˜ë¦¬ ë¶ˆí•„ìš”
        console.log('âœ… í†µí•©í…ŒìŠ¤íŠ¸ ë‹¨ê³„ ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„ì…');
      }, page);
    });
  });

  // ì½”ë“œë³‘í•©(PRD) ë‹¨ê³„: í‹°ì¼“ ì§„í–‰(ì½”ë“œë³‘í•© PRD ë‹¨ê³„) (ì„¸ë¶€ ë‹¨ê³„)
    test('ëŒ€ë©”ë‰´: í‹°ì¼“ ì§„í–‰(ì½”ë“œë³‘í•© PRD ë‹¨ê³„)', async () => {
      await test.step('ì¤‘ë©”ë‰´: í‹°ì¼“ ì§„í–‰(ì½”ë“œë³‘í•© PRD ë‹¨ê³„)', async () => {
        // ì½”ë“œë³‘í•©(PRD) ê°€ëŠ¥ í™•ì¸
        await runTestStep('ì½”ë“œë³‘í•©(PRD) ë‹¨ê³„: ì½”ë“œë³‘í•©(PRD) ê°€ëŠ¥ í™•ì¸', async () => {
          await managers.ticketCodeMergePRDManager.checkAndRefreshMergeAvailability();
        }, page);

        // ì½”ë“œë³‘í•©(PRD) ì§„í–‰
        await runTestStep('ì½”ë“œë³‘í•©(PRD) ë‹¨ê³„: ì½”ë“œë³‘í•©(PRD) ì§„í–‰', async () => {
          await managers.ticketCodeMergePRDManager.executeFullMerge();
        }, page);

        // ì½”ë“œë³‘í•©(PRD) ë‹¨ê³„ ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„ì…
        await runTestStep('ì½”ë“œë³‘í•©(PRD) ë‹¨ê³„: ì½”ë“œë³‘í•©(PRD) ë‹¨ê³„ ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„ì…', async () => {
          await managers.ticketCodeMergePRDManager.verifyMergeCompletion();
          await managers.ticketCodeMergePRDManager.proceedToNextStep();
        }, page);
      });
    });

    // ìˆ˜ë™ë°°í¬(PRD) ë‹¨ê³„: í‹°ì¼“ ì§„í–‰(ìˆ˜ë™ë°°í¬ PRD ë‹¨ê³„) (ì„¸ë¶€ ë‹¨ê³„)
    test('ëŒ€ë©”ë‰´: í‹°ì¼“ ì§„í–‰(ìˆ˜ë™ë°°í¬ PRD ë‹¨ê³„)', async () => {
      await test.step('ì¤‘ë©”ë‰´: í‹°ì¼“ ì§„í–‰(ìˆ˜ë™ë°°í¬ PRD ë‹¨ê³„)', async () => {
        // ìˆ˜ë™ë°°í¬(PRD) ì™„ë£Œ
        await runTestStep('ìˆ˜ë™ë°°í¬(PRD) ë‹¨ê³„: ìˆ˜ë™ë°°í¬(PRD)', async () => {
          await managers.ticketManualDeploymentPRDManager.processTicketManualDeployment(config);
        }, page);

        // ìˆ˜ë™ë°°í¬(PRD) ë‹¨ê³„ ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„ì…
        await runTestStep('ìˆ˜ë™ë°°í¬(PRD) ë‹¨ê³„: ìˆ˜ë™ë°°í¬(PRD) ë‹¨ê³„ ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„ì…', async () => {
          // ìˆ˜ë™ë°°í¬ í”„ë¡œì„¸ìŠ¤ì—ì„œ ì´ë¯¸ ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰í•˜ë¯€ë¡œ ë³„ë„ ì²˜ë¦¬ ë¶ˆí•„ìš”
          console.log('âœ… ìˆ˜ë™ë°°í¬(PRD) ë‹¨ê³„ ì™„ë£Œ ë° ë‹¤ìŒ ë‹¨ê³„ ì§„ì…');
        }, page);
      });
    });

  // í‹°ì¼“ ì¢…ë£Œ
  test('í‹°ì¼“ ì¢…ë£Œ', async () => {
    console.log('ğŸ¯ í‹°ì¼“ ì¢…ë£Œ ì‹œì‘');
    
    // í‹°ì¼“ ì¢…ë£Œ
    await runTestStep('í‹°ì¼“ ì¢…ë£Œ ë‹¨ê³„: í‹°ì¼“ ì¢…ë£Œ', async () => {
      await managers.ticketDeploymentInformationManager.processTicketDeploymentInformation(config);
    }, page);
  });
});
