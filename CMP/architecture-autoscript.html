<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Autoscript ì‹œìŠ¤í…œ êµ¬ì„±ë„</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 10px;
            background: #f5f5f5;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            margin-bottom: 10px;
            margin-top: 0;
        }
        .mermaid {
            background: white;
            padding: 10px;
            border-radius: 4px;
            overflow: hidden;
        }
        .mermaid svg {
            max-width: 100%;
            height: auto;
        }
        .description {
            margin-top: 30px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 4px;
            border-left: 4px solid #2196F3;
        }
        .description h2 {
            color: #333;
            margin-top: 0;
        }
        .description ul {
            line-height: 1.8;
        }
        .download-btn {
            display: inline-block;
            margin-top: 20px;
            padding: 10px 20px;
            background: #2196F3;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .download-btn:hover {
            background: #1976D2;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¤– Autoscript ì‹œìŠ¤í…œ êµ¬ì„±ë„</h1>
        <div class="mermaid">
graph TB
    subgraph "Autoscript ì‹œìŠ¤í…œ"
        subgraph "Codegen GUI Electron"
            CodegenGUI["electron-codegen-gui/<br/>Codegen GUI ì• í”Œë¦¬ì¼€ì´ì…˜"]
            CodegenMain["main.js<br/>Electron ë©”ì¸ í”„ë¡œì„¸ìŠ¤"]
            CodegenRenderer["renderer/index.html<br/>GUI í™”ë©´"]
            CodegenPreload["preload.js<br/>IPC ë¸Œë¦¿ì§€"]
            CodegenGUI --> CodegenMain
            CodegenMain --> CodegenRenderer
            CodegenMain --> CodegenPreload
        end
        
        subgraph "ë¸Œë¼ìš°ì € ì¡°ì‘ â†’ Sheets ë³€í™˜"
            Codegen["Playwright Codegen<br/>ë¸Œë¼ìš°ì € ì¡°ì‘ ë…¹í™”"]
            CodegenToSheets["codegen-to-sheets.js<br/>ë¸Œë¼ìš°ì € ì¡°ì‘ íŒŒì‹± ë° ë³€í™˜"]
            Codegen --> |ë¸Œë¼ìš°ì € ì¡°ì‘ ë°ì´í„°| CodegenToSheets
            CodegenToSheets --> |ìì—°ì–´ ë³€í™˜| NaturalLang["ìì—°ì–´ ACTION_DESC<br/>ì˜ˆ: 'ë¡œê·¸ì¸' ë²„íŠ¼ í´ë¦­í•œë‹¤"]
        end
        
        subgraph "AI ë³€í™˜ ì—”ì§„"
            AIConverter["ai-converter/index.js<br/>AI ë³€í™˜ ë©”ì¸ ë¡œì§"]
            GroqClient["ai-converter/groq-client.js<br/>Groq API í´ë¼ì´ì–¸íŠ¸"]
            MCPHelper["playwright-mcp-helper.js<br/>MCP Claude ë³€í™˜"]
            AIConverter --> |1ì°¨ ë³€í™˜| GroqClient
            AIConverter --> |2ì°¨ ë³€í™˜| MCPHelper
            CodegenToSheets --> |íŒŒì‹± ì‹¤íŒ¨ ì‹œ| AIConverter
        end
        
        subgraph "Google Sheets"
            GoogleSheets["Google Sheets API<br/>í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì €ì¥ì†Œ"]
            SheetsData["ì‹œíŠ¸ êµ¬ì¡°:<br/>CASE_ID, TITLE, STEP_NO<br/>ACTION_DESC, DATA, VARIABLE, ASSERT"]
            NaturalLang --> |ì €ì¥| GoogleSheets
            AIConverter --> |ë³€í™˜ ê²°ê³¼| GoogleSheets
            GoogleSheets --> SheetsData
        end
        
        subgraph "Sheets â†’ ì½”ë“œ ë³€í™˜"
            SheetsToCode["sheets-to-playwright-direct.js<br/>Google Sheets â†’ Playwright ì½”ë“œ"]
            SheetsData --> |ë°ì´í„° ì½ê¸°| SheetsToCode
            SheetsToCode --> |ìì—°ì–´ íŒŒì‹±| ActionParser["ì•¡ì…˜ íŒŒì„œ<br/>ì •ê·œì‹ + AI"]
            ActionParser --> |íŒŒì‹± ì‹¤íŒ¨ ì‹œ| AIConverter
            SheetsToCode --> |ì½”ë“œ ìƒì„±| GeneratedCode["ìƒì„±ëœ í…ŒìŠ¤íŠ¸ ì½”ë“œ<br/>.spec.js ë˜ëŠ” Manager.js"]
        end
        
        subgraph "ëŒ€í™”í˜• ì‹¤í–‰"
            CodegenAuto["codegen-auto-sheets.js<br/>ëŒ€í™”í˜• codegen ì‹¤í–‰"]
            CodegenAuto --> |ìë™ ì‹¤í–‰ ë° ë³€í™˜| CodegenToSheets
        end
        
        subgraph "ì„¤ì • ë° ìœ í‹¸ë¦¬í‹°"
            Config["config.json<br/>Codegen GUI ì„¤ì •"]
            SheetsAPI["sheets-api-server.js<br/>Google Sheets API ì„œë²„"]
            MergeUtil["merge-test-cases.js<br/>í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ë³‘í•©"]
            AppendUtil["append-test-cases.js<br/>í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì¶”ê°€"]
        end
        
        subgraph "ì¶œë ¥ íŒŒì¼"
            SpecFiles["tests/generated/<br/>ìƒì„±ëœ .spec.js íŒŒì¼"]
            ManagerFiles["lib/classes/<br/>ìƒì„±ëœ Manager.js íŒŒì¼"]
            GeneratedCode --> SpecFiles
            GeneratedCode --> ManagerFiles
        end
    end
    
    CodegenGUI --> |ë…¹í™” ì‹œì‘| Codegen
    CodegenGUI --> |ì½”ë“œ ë³€í™˜ ìš”ì²­| SheetsToCode
    CodegenGUI --> |ì„¤ì • ê´€ë¦¬| Config
    SheetsToCode --> |API í˜¸ì¶œ| SheetsAPI
    SheetsAPI --> |ë°ì´í„° ì½ê¸°| GoogleSheets
    
    style CodegenGUI fill:#e1f5ff
    style GoogleSheets fill:#fff4e1
    style AIConverter fill:#ffe1f5
    style SheetsToCode fill:#e1ffe1
    style CodegenToSheets fill:#f5e1ff
        </div>
        
        <div class="description">
            <h2>ì£¼ìš” ì»´í¬ë„ŒíŠ¸ ì„¤ëª…</h2>
            <ul>
                <li><strong>Codegen GUI (Electron)</strong>: electron-codegen-gui/ - ë¸Œë¼ìš°ì € ì¡°ì‘ ë…¹í™” ë° ì½”ë“œ ë³€í™˜ì„ ìœ„í•œ GUI ì• í”Œë¦¬ì¼€ì´ì…˜</li>
                <li><strong>ë¸Œë¼ìš°ì € ì¡°ì‘ â†’ Sheets ë³€í™˜</strong>: Playwright Codegenìœ¼ë¡œ ë¸Œë¼ìš°ì €ì—ì„œ ì§ì ‘ ì¡°ì‘í•œ ë‚´ìš©ì„ ë…¹í™” â†’ codegen-to-sheets.jsë¡œ íŒŒì‹± ë° ìì—°ì–´ ë³€í™˜í•˜ì—¬ Google Sheets í˜•ì‹ìœ¼ë¡œ ì €ì¥, ìì—°ì–´ ê¸°ë°˜ ACTION_DESC ìƒì„±</li>
                <li><strong>AI ë³€í™˜ ì—”ì§„</strong>: ì •ê·œì‹ íŒŒì‹± ì‹¤íŒ¨ ì‹œ Groq API(1ì°¨) â†’ MCP Claude Sonnet 4(2ì°¨) ìˆœì„œë¡œ ìë™ ë³€í™˜ ìˆ˜í–‰</li>
                <li><strong>Google Sheets</strong>: í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì¤‘ì•™ ì €ì¥ì†Œ, ì œí’ˆë³„ ì‹œíŠ¸ íƒ­ (TROMBONE, VIOLA, CONTRABASS, CMP)</li>
                <li><strong>Sheets â†’ ì½”ë“œ ë³€í™˜</strong>: sheets-to-playwright-direct.jsë¡œ Google Sheets ë°ì´í„°ë¥¼ Playwright ì½”ë“œë¡œ ë³€í™˜, .spec.js íŒŒì¼ ë˜ëŠ” Manager í´ë˜ìŠ¤ ìƒì„±</li>
                <li><strong>ëŒ€í™”í˜• ì‹¤í–‰</strong>: codegen-auto-sheets.jsë¡œ ëŒ€í™”í˜•ìœ¼ë¡œ codegen ì‹¤í–‰ ë° ìë™ ë³€í™˜</li>
                <li><strong>ì„¤ì • ë° ìœ í‹¸ë¦¬í‹°</strong>: config.json, sheets-api-server.js, merge-test-cases.js, append-test-cases.js</li>
            </ul>
            
            <h3>ë°ì´í„° í”Œë¡œìš°</h3>
            <ol>
                <li><strong>ë¸Œë¼ìš°ì € ì¡°ì‘ â†’ Sheets</strong>: Playwright Codegenìœ¼ë¡œ ë¸Œë¼ìš°ì € ì¡°ì‘ ë…¹í™” â†’ codegen-to-sheets.jsë¡œ íŒŒì‹± ë° ìì—°ì–´ ë³€í™˜ â†’ Google Sheets ì €ì¥</li>
                <li><strong>Sheets â†’ ì½”ë“œ</strong>: sheets-to-playwright-direct.jsë¡œ Sheets ë°ì´í„° ì½ê¸° â†’ ìì—°ì–´ íŒŒì‹± â†’ í…ŒìŠ¤íŠ¸ ì½”ë“œ ìƒì„±</li>
                <li><strong>AI ë³€í™˜</strong>: íŒŒì‹± ì‹¤íŒ¨ ì‹œ Groq API â†’ MCP Claude ìˆœì„œë¡œ ìë™ ë³€í™˜</li>
            </ol>
        </div>
        
        <button class="download-btn" onclick="downloadAsImage()">ì´ë¯¸ì§€ë¡œ ì €ì¥</button>
    </div>
    
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            }
        });
        
        // ë‹¤ì´ì–´ê·¸ë¨ ë¡œë“œ í›„ ë¶ˆí•„ìš”í•œ ì—¬ë°± ì œê±°
        window.addEventListener('load', function() {
            setTimeout(function() {
                const svg = document.querySelector('.mermaid svg');
                if (svg) {
                    // SVGì˜ ì‹¤ì œ í¬ê¸°ì— ë§ì¶° ì»¨í…Œì´ë„ˆ ì¡°ì •
                    const bbox = svg.getBBox();
                    const mermaidContainer = document.querySelector('.mermaid');
                    if (mermaidContainer) {
                        mermaidContainer.style.height = 'auto';
                        mermaidContainer.style.paddingBottom = '10px';
                    }
                }
            }, 500);
        });
        
        function downloadAsImage() {
            try {
                const svg = document.querySelector('.mermaid svg');
                if (!svg) {
                    alert('SVGë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë‹¤ì´ì–´ê·¸ë¨ì´ ë¡œë“œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.');
                    return;
                }
                
                // ì›ë³¸ SVGì˜ í¬ê¸° ì •ë³´ ê°€ì ¸ì˜¤ê¸°
                const viewBox = svg.getAttribute('viewBox');
                const svgWidth = svg.getAttribute('width');
                const svgHeight = svg.getAttribute('height');
                
                // viewBoxì—ì„œ í¬ê¸° ì¶”ì¶œ
                let width, height;
                if (viewBox) {
                    const parts = viewBox.split(' ');
                    width = parseFloat(parts[2]);
                    height = parseFloat(parts[3]);
                } else {
                    width = parseFloat(svgWidth) || 1200;
                    height = parseFloat(svgHeight) || 800;
                }
                
                // SVG ë³µì‚¬ë³¸ ìƒì„± (ì›ë³¸ ë³€ê²½ ë°©ì§€)
                const svgClone = svg.cloneNode(true);
                
                // ë³µì‚¬ë³¸ì˜ ì†ì„± ì„¤ì •
                svgClone.setAttribute('width', width);
                svgClone.setAttribute('height', height);
                if (viewBox) {
                    svgClone.setAttribute('viewBox', viewBox);
                }
                
                // ë„¤ì„ìŠ¤í˜ì´ìŠ¤ í™•ì¸ ë° ì¶”ê°€
                if (!svgClone.getAttribute('xmlns')) {
                    svgClone.setAttribute('xmlns', 'http://www.w3.org/2000/svg');
                }
                
                // SVG ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                const svgData = new XMLSerializer().serializeToString(svgClone);
                
                // SVGë¥¼ base64ë¡œ ì¸ì½”ë”©
                const base64Svg = btoa(unescape(encodeURIComponent(svgData)));
                const svgDataUri = 'data:image/svg+xml;base64,' + base64Svg;
                
                // Canvas ìƒì„±
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                const img = new Image();
                
                // CORS ë¬¸ì œ ë°©ì§€ë¥¼ ìœ„í•´ crossOrigin ì„¤ì •
                img.crossOrigin = 'anonymous';
                
                img.onload = function() {
                    try {
                        // Canvas í¬ê¸°ë¥¼ ì´ë¯¸ì§€ í¬ê¸°ì— ë§ì¶¤
                        canvas.width = img.width;
                        canvas.height = img.height;
                        
                        // ë°°ê²½ìƒ‰ ì„¤ì •
                        ctx.fillStyle = 'white';
                        ctx.fillRect(0, 0, canvas.width, canvas.height);
                        
                        // ì´ë¯¸ì§€ ê·¸ë¦¬ê¸°
                        ctx.drawImage(img, 0, 0);
                        
                        // PNGë¡œ ë³€í™˜í•˜ì—¬ ë‹¤ìš´ë¡œë“œ
                        canvas.toBlob(function(blob) {
                            if (!blob) {
                                alert('ì´ë¯¸ì§€ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                                return;
                            }
                            
                            const link = document.createElement('a');
                            link.download = 'architecture-autoscript.png';
                            link.href = URL.createObjectURL(blob);
                            document.body.appendChild(link);
                            link.click();
                            document.body.removeChild(link);
                            
                            // ë©”ëª¨ë¦¬ ì •ë¦¬
                            URL.revokeObjectURL(link.href);
                            
                            console.log('ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ');
                        }, 'image/png');
                    } catch (error) {
                        console.error('ì´ë¯¸ì§€ ë³€í™˜ ì˜¤ë¥˜:', error);
                        alert('ì´ë¯¸ì§€ ë³€í™˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
                    }
                };
                
                img.onerror = function() {
                    console.error('ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨');
                    alert('SVG ì´ë¯¸ì§€ ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                };
                
                img.src = svgDataUri;
            } catch (error) {
                console.error('ë‹¤ìš´ë¡œë“œ ì˜¤ë¥˜:', error);
                alert('ì´ë¯¸ì§€ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }
    </script>
</body>
</html>

