# Codegen Autoscript GUI 사용 가이드

## 📖 목차
1. [실행 방법](#실행-방법)
2. [기본 설정](#기본-설정)
3. [주요 기능](#주요-기능)
4. [사용 시나리오](#사용-시나리오)
5. [문제 해결](#문제-해결)

---

## 🚀 실행 방법

### Windows
```cmd
cd autoscript
run-codegen-gui.bat
```

또는 직접:
```cmd
cd autoscript/electron-codegen-gui
npm start
```

### macOS / Linux
```bash
cd autoscript
chmod +x run-codegen-gui.sh
./run-codegen-gui.sh
```

---

## ⚙️ 기본 설정

### 1. 첫 실행 시 설정
애플리케이션을 처음 실행하면 기본 설정이 자동으로 생성됩니다.

### 2. Google Sheets 설정 변경
1. 우측 상단의 **⚙️ 설정** 버튼 클릭
2. **Google Sheets ID** 입력
   - URL: `https://docs.google.com/spreadsheets/d/[이 부분이 ID]/edit`
   - 예: `1vN9234uKv5WdwZMy7e3aPq8aZjR8Zr0fPqE9aQx6bYc`
3. **인증 파일 경로** 선택
   - "찾아보기" 버튼으로 Service Account JSON 파일 선택
4. **저장** 클릭

### 3. 제품 선택
사이드바에서 작업할 제품 선택:
- TROMBONE
- VIOLA
- CMP
- CONTRABASS

---

## 🎯 주요 기능

### 1. 🎬 Codegen 녹화

**목적:** 브라우저 조작을 녹화하여 테스트 케이스 자동 생성

**단계:**
1. **시작 URL** 입력 (예: `http://trombone.qa.okestro.cloud/`)
2. **케이스 ID** 입력 (예: `TC001`)
3. **테스트 제목** 입력 (예: `로그인 테스트`)
4. **"Codegen 녹화 시작"** 버튼 클릭
5. 열린 브라우저에서 테스트할 동작 수행
6. 완료 후 브라우저 닫기
7. 자동으로 Google Sheets에 저장됨

**결과:**
- Google Sheets에 액션별로 저장됨
- 최근 케이스 목록에 추가됨

---

### 2. 📝 코드 생성

**목적:** Google Sheets 데이터를 Playwright 테스트 코드로 변환

**단계:**
1. **"코드 생성"** 탭 클릭
2. **케이스 ID** 입력 (Google Sheets에 있는 ID)
3. **"테스트 코드 생성"** 버튼 클릭
4. 생성 완료 후 **"생성된 파일 열기"** 클릭

**결과:**
- `autoscript/tests/generated/[케이스ID].spec.js` 파일 생성
- 파일 탐색기에서 자동으로 열림

---

### 3. 📋 케이스 목록

**목적:** Google Sheets에 저장된 모든 케이스 조회

**단계:**
1. **"케이스 목록"** 탭 클릭
2. **"목록 새로고침"** 버튼 클릭
3. 케이스 목록 표시됨
4. 원하는 케이스의 **"사용"** 버튼 클릭
   → 자동으로 "코드 생성" 탭으로 이동하며 케이스 ID 입력됨

---

### 4. 🌐 Sheet 관리

**Sheet 브라우저에서 열기:**
- 사이드바의 **"🌐 브라우저에서 열기"** 버튼 클릭
- 기본 브라우저에서 Google Sheets가 열림
- 직접 데이터 확인 및 수정 가능

**케이스 목록 바로가기:**
- 사이드바의 **"📋 케이스 목록 보기"** 버튼 클릭
- "케이스 목록" 탭으로 이동 + 자동 새로고침

---

### 5. 🕒 최근 케이스

**목적:** 최근 작업한 케이스 빠른 접근

**사용법:**
- 사이드바에 최근 5개 케이스 표시
- 케이스 클릭 시 Codegen 탭의 입력 필드에 자동 입력
- 빠르게 동일한 케이스로 재작업 가능

---

### 6. 📝 실행 로그

**기능:**
- 모든 작업의 실시간 로그 출력
- 성공/실패 상태 확인
- 에러 메시지 표시

**로그 타입:**
- 🔵 **정보:** 일반 동작
- 🟢 **성공:** 작업 완료
- 🟡 **경고:** 주의 필요
- 🔴 **오류:** 실패 상황

**로그 지우기:**
- 우측 하단의 **"지우기"** 버튼 클릭

---

## 📚 사용 시나리오

### 시나리오 1: 새 테스트 케이스 작성

```
목표: TROMBONE 로그인 테스트 케이스 작성
```

1. **제품 선택**
   - 사이드바에서 **TROMBONE** 선택

2. **Codegen 녹화**
   - "Codegen 녹화" 탭
   - URL: `http://trombone.qa.okestro.cloud/`
   - 케이스 ID: `TC001`
   - 제목: `사용자 로그인 테스트`
   - "Codegen 녹화 시작" 클릭

3. **브라우저 조작**
   - 로그인 페이지에서 ID/PW 입력
   - 로그인 버튼 클릭
   - 대시보드 확인
   - 브라우저 닫기

4. **확인**
   - 로그에 "✅ Google Sheets 저장 완료" 표시
   - 사이드바 "최근 케이스"에 추가됨

---

### 시나리오 2: 기존 케이스로 테스트 코드 생성

```
목표: Sheet의 TC001을 Playwright 코드로 변환
```

1. **케이스 확인**
   - "케이스 목록" 탭 클릭
   - "목록 새로고침" 클릭
   - TC001이 목록에 있는지 확인

2. **코드 생성**
   - TC001의 "사용" 버튼 클릭
   - 자동으로 "코드 생성" 탭 이동
   - "테스트 코드 생성" 클릭

3. **결과 확인**
   - 로그: "✅ 테스트 코드 생성 완료: TC001.spec.js"
   - "생성된 파일 열기" 클릭
   - 파일 탐색기에서 자동으로 열림

4. **테스트 실행**
   - 터미널에서 실행:
     ```bash
     npx playwright test autoscript/tests/generated/TC001.spec.js
     ```

---

### 시나리오 3: 여러 제품에 동일 케이스 적용

```
목표: 로그인 테스트를 4개 제품 모두에 작성
```

1. **TROMBONE**
   - 제품 선택: TROMBONE
   - TC001_TROMBONE 녹화

2. **VIOLA**
   - 제품 선택: VIOLA
   - TC001_VIOLA 녹화

3. **CMP**
   - 제품 선택: CMP
   - TC001_CMP 녹화

4. **CONTRABASS**
   - 제품 선택: CONTRABASS
   - TC001_CONTRABASS 녹화

**팁:** 케이스 ID에 제품명을 포함하면 관리가 쉬움

---

## 🔧 문제 해결

### ❌ "Codegen 실행 실패"

**원인:**
- Playwright가 설치되지 않음

**해결:**
```bash
cd autoscript
npx playwright install
```

---

### ❌ "Google Sheets 연동 실패"

**원인 1:** Sheets ID 오류
- 설정에서 올바른 Sheets ID 입력했는지 확인

**원인 2:** 인증 파일 오류
- Service Account JSON 파일 경로 확인
- 파일이 존재하는지 확인

**원인 3:** 권한 오류
- Google Sheets에 Service Account 이메일 추가
- 편집 권한 부여

---

### ❌ "케이스 목록 조회 실패"

**해결:**
1. 설정에서 Sheets ID 재확인
2. 브라우저에서 Sheet 열어서 데이터 확인
3. 인증 파일 권한 확인

---

### ❌ "테스트 코드 생성 실패"

**원인:** 해당 케이스가 Google Sheets에 없음

**해결:**
1. "케이스 목록" 탭에서 케이스 존재 확인
2. 브라우저에서 Sheet 열어서 직접 확인
3. 케이스 ID 정확히 입력했는지 확인

---

### ⚠️ 앱이 느릴 때

**해결:**
1. 로그 지우기 (로그가 너무 많으면 느려짐)
2. 앱 재시작 (우측 상단 🔄 버튼)
3. 케이스 목록이 너무 많으면 Sheet 정리

---

## 💡 팁 & 트릭

### 1. 빠른 케이스 작성
- 최근 케이스 활용: 사이드바에서 클릭만으로 재사용
- Enter 키: 입력 필드에서 Enter로 바로 실행

### 2. 효율적인 케이스 ID 명명
```
[제품]_[카테고리]_[번호]

예시:
- TROMBONE_LOGIN_001
- VIOLA_CLUSTER_CREATE_001
- CMP_USER_MANAGE_001
```

### 3. Sheet 직접 수정
- 브라우저에서 Sheet 열기
- 액션 순서 변경, 데이터 수정
- 다시 코드 생성하면 변경사항 반영됨

### 4. 로그 활용
- 에러 발생 시 로그 복사해서 디버깅
- 로그에 파일 경로 표시됨

---

## 📞 추가 도움

### 문서
- `README.md`: 기본 실행 방법
- `autoscript/README.md`: CLI 버전 사용법

### 기존 CLI 도구도 계속 사용 가능
```bash
npm run codegen:auto
npm run autoscript TC001
```

---

**마지막 업데이트:** 2025년 10월 15일  
**버전:** 1.0.0

